(function(){"use strict";var e={6676:function(e,t,o){var n={};o.r(n),o.d(n,{IsShowTabBar:function(){return Kt},getLocalItem:function(){return Zt}});var a={};o.r(a),o.d(a,{SelectTabBar:function(){return Gt},removeLocalItem:function(){return to},setDatabase:function(){return Qt},setLocalItem:function(){return eo},setRefreshListState:function(){return Xt}});var l={};o.r(l),o.d(l,{addCategory:function(){return yo},addCyNote:function(){return vo},addNote:function(){return ko},delCategory:function(){return Po},delNote:function(){return _o},getCategoryById:function(){return Ho},getCategoryList:function(){return Fo},getCyNoteList:function(){return So},getCyNoteListByPage:function(){return po},getNoteById:function(){return go},getNoteList:function(){return xo},getNoteListByPage:function(){return mo},getNoteListByParentId:function(){return To},getNoteListNearMonth:function(){return Co},hasNoteOnYearMonthDate:function(){return bo},startupDatabase:function(){return Oo},updateCategory:function(){return wo},updateNote:function(){return Do},updateNoteSort:function(){return Lo},updateNoteTimestamp:function(){return Io}});var i=o(2382),c=o(9242),s=o(3396);const r=(0,s.Uk)("笔记"),u=(0,s.Uk)("归类"),d=(0,s.Uk)("日历"),f=(0,s.Uk)("设置");function h(e,t,o,n,a,l){const i=(0,s.up)("router-view"),h=(0,s.up)("van-tabbar-item"),g=(0,s.up)("van-tabbar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,null,{default:(0,s.w5)((({Component:e})=>[((0,s.wg)(),(0,s.j4)(s.Ob,null,[((0,s.wg)(),(0,s.j4)((0,s.LL)(e)))],1024))])),_:1}),(0,s.Wm)(i,{name:"NewNote"}),(0,s.Wm)(i,{name:"SearchNote"},{default:(0,s.w5)((({Component:e})=>[((0,s.wg)(),(0,s.j4)(s.Ob,null,[((0,s.wg)(),(0,s.j4)((0,s.LL)(e)))],1024))])),_:1}),(0,s.wy)((0,s.Wm)(g,{route:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{icon:"notes-o",to:"/"},{default:(0,s.w5)((()=>[r])),_:1}),(0,s.Wm)(h,{icon:"apps-o",to:"/Category"},{default:(0,s.w5)((()=>[u])),_:1}),(0,s.Wm)(h,{icon:"calendar-o",to:"/Calendar"},{default:(0,s.w5)((()=>[d])),_:1}),(0,s.Wm)(h,{icon:"setting-o",to:"/Setting"},{default:(0,s.w5)((()=>[f])),_:1})])),_:1},512),[[c.F8,e.IsShowTabBar]])],64)}var g=o(4870),b=o(678),m=o(65);function p(){return new Promise(((e,t)=>{FingerprintAuth.isAvailable((o=>{if(o.isAvailable){var n={clientId:"com.github.topcoder520_debug",usename:"myUsername",password:"myPassword",disableBackup:!1,maxAttempts:"5",locale:"zh_CN",userAuthRequired:"false",dialogTitle:"指纹验证",dialogMessage:"请触摸指纹传感器",dialogHint:"本次验证不会保存您的指纹信息"};FingerprintAuth.encrypt(n,(t=>{e(t)}),(e=>{t({code:3,msg:"指纹解锁授权失败"})}))}else t({code:2,msg:"指纹解锁不可用"})}),(e=>{t({code:1,msg:e})}))}))}var v=o(5741),y={setup(){const e=(0,b.tv)(),t=(0,g.iH)(0),o=(0,m.oR)();(0,s.bv)((()=>{o.dispatch("startupDatabase").then((()=>{n().then((t=>{console.log("flag",t),"true"==t?(console.log("开启指纹解锁"),p().then((t=>{console.log("FingerprintVerification"+JSON.stringify(t)),e.push({path:"/"})})).catch((e=>{console.log("FingerprintVerification",JSON.stringify(e)),3==e.code?navigator.app.exitApp():(0,v.FN)(e.msg)}))):(console.log("不不不开启指纹解锁"),e.push({path:"/"}))}))})).catch((e=>{console.log("startupDatabase-err=>"+e)}))}));const n=async()=>await o.getters.getLocalItem(o.state.localFingerKey);return{active:t}},computed:{...(0,m.Se)(["IsShowTabBar"])}},w=o(89);const I=(0,w.Z)(y,[["render",h]]);var N=I,C=o(7139);const S={class:"list-box"},x={class:"van-multi-ellipsis--l3"},T={class:"status"},k={class:"status-over"},D={style:{"margin-right":"8px"}},L={class:"top-tag"},_={class:"add-box"};function P(e,t,o,n,a,l){const i=(0,s.up)("van-icon"),r=(0,s.up)("router-link"),u=(0,s.up)("van-nav-bar"),d=(0,s.up)("van-button"),f=(0,s.up)("van-col"),h=(0,s.up)("van-row"),g=(0,s.up)("van-swipe-cell"),b=(0,s.up)("van-list"),m=(0,s.up)("van-pull-refresh");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.wy)((0,s.Wm)(u,{class:"list-title",title:"待完成列表"},{right:(0,s.w5)((()=>[n.showSwitchBtn?((0,s.wg)(),(0,s.j4)(r,{key:0,to:"/Search?lz=1"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search",size:"22"})])),_:1})):(0,s.kq)("",!0)])),_:1},512),[[c.F8,n.showNavbar]]),(0,s._)("div",S,[(0,s.Wm)(m,{modelValue:n.Refresh,"onUpdate:modelValue":t[1]||(t[1]=e=>n.Refresh=e),onRefresh:n.onRefresh},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{loading:n.loading,"onUpdate:loading":t[0]||(t[0]=e=>n.loading=e),finished:n.finished,"finished-text":"没有更多了",onLoad:n.onLoad},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.list,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"before-close":n.beforeClose},(0,s.Nv)({right:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(d,{square:"",style:{height:"100% !important"},text:"已完成",onClick:t=>n.preDelItem(e.Id),type:"danger",class:"delete-button"},null,8,["onClick"]),[[c.F8,1==e.State]]),(0,s.wy)((0,s.Wm)(d,{square:"",type:"success",style:{height:"100% !important"},text:"待完成",onClick:t=>n.setNotState(e.Id,e.Sort)},null,8,["onClick"]),[[c.F8,!n.showSwitchBtn&&0==e.State]])])),default:(0,s.w5)((()=>[(0,s.Wm)(h,{onClick:t=>n.onNoteDetail(e.Id)},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:"24"},{default:(0,s.w5)((()=>[(0,s._)("p",x,(0,C.zw)(e.Title),1),(0,s._)("p",null,[(0,s.wy)((0,s._)("span",T,null,512),[[c.F8,1==e.State]]),(0,s.wy)((0,s._)("span",k,null,512),[[c.F8,0==e.State]]),(0,s._)("span",D,(0,C.zw)(e.Category.split("/")[0]),1),(0,s.Uk)((0,C.zw)(e.CreateTime),1),(0,s.wy)((0,s._)("span",L,"置顶",512),[[c.F8,e.Sort>1]])])])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},[n.showSwitchBtn?{name:"left",fn:(0,s.w5)((()=>[(0,s.Wm)(d,{square:"",type:"primary",style:{height:"100% !important"},text:e.Sort>1?"取消置顶":"置顶",onClick:t=>n.topItem(e.Id,e.Sort)},null,8,["text","onClick"])]))}:void 0]),1032,["before-close"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1},8,["modelValue","onRefresh"]),(0,s.wy)((0,s._)("div",_,[(0,s._)("span",{class:"border",onClick:t[2]||(t[2]=(...e)=>n.addNote&&n.addNote(...e))},[(0,s.Wm)(i,{name:"plus"})])],512),[[c.F8,n.showNavbar]])])],64)}var F=o(9650),H=o(253);const O={name:"NotesView",props:{Date:{type:Object,default:()=>({Year:0,Month:0,Day:0})},IsAll:Boolean,ShowNavBar:{type:Boolean,default:()=>!0},Lazyload:{type:Boolean,default:()=>!1},QueryItem:{type:Object,default:()=>({ParentId:0,note_category_Id:-1,Keywords:""})}},emits:{openNotedetail:null},setup(e,t){const o=(0,b.tv)(),n=(0,m.oR)(),a=(0,g.iH)(!1),l=(0,g.iH)([]),i=(0,g.iH)(!1),c=(0,g.iH)(!1);var r=0;const u=()=>{d.value||setTimeout((()=>{(0,v.FN)("刷新成功"),r=1,l.value=[],console.log("getNoteListByPage5"),N(r,20),a.value=!1}),1e3)},d=(0,g.iH)(e.Lazyload),f=()=>{d.value?i.value=!1:(r+=1,console.log("getNoteListByPage6"),N(r,20))};let h=0;const p=t=>{h=t,console.log(h),(0,F.WD)({title:"该任务已完成？",className:"task-finish-dialog",overlayClass:"task-finish-overlay"}).then((()=>{n.dispatch("delNote",{Id:h,real:0}).then(((t,o)=>{if(t.rowsAffected>0)for(let n=0;n<l.value.length;n++){const t=l.value[n];if(t.Id==h){e.IsAll?t.State=0:l.value.splice(n,1);break}}else v.FN.fail("移出失败："+o)}))})).catch((()=>{}))},y=(e,t)=>{t>1?n.dispatch("updateNoteSort",{Id:e,Sort:1}).then((e=>{e.rowsAffected>0&&(r=1,l.value=[],console.log("getNoteListByPage7"),N(r,20),setTimeout((function(){(0,v.FN)("已取消置顶")}),300))})).catch((e=>{v.FN.fail("取消置顶失败："+e)})):n.dispatch("updateNoteSort",{Id:e,Sort:Date.now()}).then((e=>{e.rowsAffected>0&&(r=1,l.value=[],console.log("getNoteListByPage1"),N(r,20),setTimeout((function(){(0,v.FN)("已置顶")}),300))})).catch((e=>{v.FN.fail("置顶失败："+e)}))},w=(e,t)=>{(0,F.WD)({title:"设置任务状态未完成？",className:"task-finish-dialog",overlayClass:"task-finish-overlay"}).then((()=>{n.dispatch("updateNoteSort",{Id:e,Sort:t}).then((t=>{if(t.rowsAffected>0){for(let t=0;t<l.value.length;t++){const o=l.value[t];if(o.Id==e){o.State=1;break}}setTimeout((function(){(0,v.FN)("已进入待完成列表")}),300)}})).catch((e=>{v.FN.fail("设置失败："+e)}))})).catch((()=>{}))},I=({position:e})=>{switch(e){case"left":return new Promise((()=>{console.log("click left")}));case"cell":case"outside":return!0;case"right":return new Promise((()=>{}))}};(0,s.dl)((()=>{d.value=!1,n.commit("SelectTabBar",-1);const e=n.state.RefreshListState;console.log("store.state.RefreshListState:"+e,typeof e),e&&(n.commit("setRefreshListState",!1),l.value=[],r=1,console.log("getNoteListByPage2"),N(r,20))})),(0,s.YP)((()=>e.Date),((e,t)=>{console.log(JSON.stringify(e),JSON.stringify(t)),l.value=[],r=1,console.log("getNoteListByPage3"),d.value=!1,N(r,20)}),{deep:!0}),(0,s.YP)((()=>e.QueryItem),((e,t)=>{console.log(JSON.stringify(e),JSON.stringify(t)),l.value=[],r=1,console.log("getNoteListByPage3"),d.value=!1,N(r,20)}),{deep:!0});const N=(t,o)=>{c.value=!1;let a=e.QueryItem.Keywords;console.log(t+", "+o+", "+e.Date.Year+", "+e.Date.Month+", "+e.Date.Day+", "+a),n.dispatch("getNoteListByPage",{pageIndex:t,pageSize:o,Year:e.Date.Year,Month:e.Date.Month,Day:e.Date.Day,State:e.IsAll?0:1,Sort:e.IsAll,kw:a,ParentId:e.QueryItem.ParentId,note_category_Id:e.QueryItem.note_category_Id}).then((e=>{var t=e;console.log("getNoteListByPage=>"+JSON.stringify(t));for(let o=0;o<t.length;o++)l.value.push(t[o]);i.value=!1,0==t.length&&(c.value=!0)}))},C=e=>{console.log(e),t.emit("openNotedetail",{Id:e}),o.push({path:"/ViewNote",query:{Id:e}})},S=(0,g.iH)(e.ShowNavBar),{height:x}=(0,H.iP)(),T=(0,g.iH)((e.IsAll?x.value-46-100:x.value-46)+"px"),k=(0,g.iH)("0px");e.IsAll||(k.value="80px");const D=()=>{o.push({path:"/AddNote"})};return{Refresh:a,onRefresh:u,list:l,onLoad:f,loading:i,finished:c,onNoteDetail:C,preDelItem:p,beforeClose:I,vheight:T,marginbottom:k,showNavbar:S,showSwitchBtn:!e.IsAll,addNote:D,setNotState:w,topItem:y}}},U=()=>{(0,c.sj)((e=>({"650b1d9c":e.marginbottom,"6007ea0c":e.vheight})))},R=O.setup;O.setup=R?(e,t)=>(U(),R(e,t)):U;var A=O;const W=(0,w.Z)(A,[["render",P]]);var M=W;const B={class:"addcontent",ref:"root"},Y={class:"category-name"},j={class:"note-content"};function V(e,t,o,n,a,l){const i=(0,s.up)("van-nav-bar"),r=(0,s.up)("van-icon"),u=(0,s.up)("van-cell"),d=(0,s.up)("rich-text"),f=(0,s.up)("van-cascader"),h=(0,s.up)("van-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,{class:"nav-bar-addnote",title:n.PageTitle,"left-text":"返回","right-text":"保存","left-arrow":"",onClickLeft:n.onClickLeft,onClickRight:n.onClickRight},null,8,["title","onClickLeft","onClickRight"]),(0,s._)("div",B,[(0,s.wy)((0,s._)("input",{type:"text",class:"title",placeholder:"标题","onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e)},null,512),[[c.nr,n.title]]),(0,s.Wm)(u,{class:"date-info",title:n.createTime,"onUpdate:title":t[2]||(t[2]=e=>n.createTime=e)},{"right-icon":(0,s.w5)((()=>[(0,s._)("div",{style:{display:"inline-block"},onClick:t[1]||(t[1]=e=>n.showPopup=!0)},[(0,s._)("label",Y,(0,C.zw)(n.categoryName),1),(0,s.Wm)(r,{class:"arrow-down",size:"20px",name:"arrow-down"})])])),_:1},8,["title"]),(0,s._)("div",j,[(0,s.Wm)(d,{onGetValue:n.getValue,value:n.tmepContent},null,8,["onGetValue","value"])])],512),(0,s.Wm)(h,{show:n.showPopup,"onUpdate:show":t[5]||(t[5]=e=>n.showPopup=e),round:"",position:"bottom"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{modelValue:n.cascaderValue,"onUpdate:modelValue":t[3]||(t[3]=e=>n.cascaderValue=e),title:"请选择知识库和分类",options:n.options,onClose:t[4]||(t[4]=e=>n.showPopup=!1),onChange:n.onChange,onFinish:n.onFinish},null,8,["modelValue","options","onChange","onFinish"])])),_:1},8,["show"])],64)}function q(e){const t=new Date;let o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),l=t.getHours(),i=t.getMinutes();return n=n<10?"0"+n:n,a=a<10?"0"+a:a,l=l<10?"0"+l:l,i=i<10?"0"+i:i,e&&1===e?[o,"-",n,"-",a," ",l,":",i].join(""):[o,"年",n,"月",a,"日 ",l,":",i].join("")}function E(){return Date.now()}function J(e,t){return t>12&&(t=12),t<0&&(t=1),1==t?(e-=1,t=12):t-=1,{Year:e,Month:t}}function z(e,t){return t>12&&(t=12),t<0&&(t=1),12==t?(e+=1,t=1):t+=1,{Year:e,Month:t}}var $=o(868);const K=["contenteditable"],Z={key:1,class:"tooltip"},G=(0,s._)("span",null,"A",-1),Q=[G];function X(e,t,o,n,a,l){const i=(0,s.up)("van-back-top"),r=(0,s.up)("van-icon"),u=(0,s.up)("van-dialog"),d=(0,s.up)("van-image-preview"),f=(0,s.up)("van-action-sheet");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{id:"richTextID",class:"richText",onClick:t[0]||(t[0]=(...e)=>n.clickRichText&&n.clickRichText(...e)),contenteditable:n.editable,onKeydown:t[1]||(t[1]=(0,c.D2)(((...e)=>n.enterKeydown&&n.enterKeydown(...e)),["enter"])),onBlur:t[2]||(t[2]=(...e)=>n.blurRichText&&n.blurRichText(...e)),ref:"richDiv"},null,40,K),n.editable?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(i,{key:0,target:".richText",bottom:"10vh",right:"3vw"})),n.editable?((0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("button",{onClick:t[3]||(t[3]=e=>n.changeFont("B"))},"B"),(0,s._)("button",{class:"under",onClick:t[4]||(t[4]=e=>n.changeFont("U"))},"U"),(0,s._)("button",{onClick:t[5]||(t[5]=e=>n.changeFont("I"))},"I"),(0,s._)("button",{onClick:t[6]||(t[6]=e=>n.changeFont("L"))},[(0,s.Wm)(r,{name:"link-o"})]),(0,s._)("button",{class:"fontColor",onClick:t[7]||(t[7]=e=>n.changeFont("A"))},"A"),(0,s._)("button",{class:"backFontColor",onClick:t[8]||(t[8]=e=>n.changeFont("AB"))},Q),(0,s._)("button",{onClick:t[9]||(t[9]=e=>n.changeFont("PH"))},[(0,s.Wm)(r,{name:"photo-o"})]),(0,s._)("button",{onClick:t[10]||(t[10]=e=>n.changeFont("PH2"))},[(0,s.Wm)(r,{name:"photo"})]),(0,s._)("button",{onClick:t[11]||(t[11]=e=>n.changeFont("Camera"))},[(0,s.Wm)(r,{name:"photograph"})]),(0,s._)("button",{onClick:t[12]||(t[12]=e=>n.changeFont("TODO"))},[(0,s.Wm)(r,{name:"certificate"})]),(0,s._)("button",{onClick:t[13]||(t[13]=e=>n.changeFont("BList"))},[(0,s.Wm)(r,{name:"bars"})]),(0,s._)("button",{onClick:t[14]||(t[14]=e=>n.changeFont("NList"))},[(0,s.Wm)(r,{name:"descending"})]),(0,s._)("button",{onClick:t[15]||(t[15]=e=>n.changeFont("Time"))},[(0,s.Wm)(r,{name:"tosend"})]),(0,s._)("button",{onClick:t[16]||(t[16]=e=>n.changeFont("SelFile"))},[(0,s.Wm)(r,{name:"description"})])])):(0,s.kq)("",!0),(0,s.Wm)(u,{class:"showPicUrlDialog",show:n.showPicUrl,"onUpdate:show":t[18]||(t[18]=e=>n.showPicUrl=e),title:"图片地址","show-cancel-button":"",onConfirm:n.showPicUrlconfirm,onClosed:e.reCursorposition},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":t[17]||(t[17]=e=>n.picUrl=e),rows:"6",style:{width:"96%",border:"1px solid #e1dcdc"}},null,512),[[c.nr,n.picUrl]])])),_:1},8,["show","onConfirm","onClosed"]),(0,s.Wm)(u,{class:"showPicUrlDialog",show:n.showLinkUrl,"onUpdate:show":t[20]||(t[20]=e=>n.showLinkUrl=e),title:"设置超链接","show-cancel-button":"",onConfirm:n.showLinkUrlconfirm},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":t[19]||(t[19]=e=>n.linkUrl=e),rows:"6",style:{width:"96%",border:"1px solid #e1dcdc"}},null,512),[[c.nr,n.linkUrl]])])),_:1},8,["show","onConfirm"]),(0,s.Wm)(d,{show:n.showPreview,"onUpdate:show":t[21]||(t[21]=e=>n.showPreview=e),"start-position":n.startPosition,images:n.previewImages,onLongPress:n.onLongPressEvent,onChange:n.onPreviewChange},{previewIndex:(0,s.w5)((()=>[(0,s.Uk)("第"+(0,C.zw)(n.previewIndex+1)+"页",1)])),_:1},8,["show","start-position","images","onLongPress","onChange"]),(0,s.Wm)(f,{show:n.showDownPic,"onUpdate:show":t[22]||(t[22]=e=>n.showDownPic=e),onSelect:n.selectDownPicSheet,actions:n.actionsPic,"cancel-text":"取消","close-on-click-action":"",onCancel:n.onCancelDownPic},null,8,["show","onSelect","actions","onCancel"]),(0,s.Wm)(u,{class:"showPicUrlDialog",show:n.showEditFileName,"onUpdate:show":t[24]||(t[24]=e=>n.showEditFileName=e),title:"文件名","show-cancel-button":"",onConfirm:n.onEditFileNameConfirm,onClosed:e.reCursorposition},{default:(0,s.w5)((()=>[(0,s._)("p",null,(0,C.zw)(n.selectFileName),1),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":t[23]||(t[23]=e=>n.editFileName=e),placeholder:"输入文件名",rows:"4",style:{width:"96%",border:"1px solid #e1dcdc"}},null,512),[[c.nr,n.editFileName]])])),_:1},8,["show","onConfirm","onClosed"]),(0,s.Wm)(f,{show:n.showFileActionSheet,"onUpdate:show":t[25]||(t[25]=e=>n.showFileActionSheet=e),onSelect:n.selectEditFileSheet,actions:n.actionsFileItem,"cancel-text":"取消",description:n.editFileActionDes,"close-on-click-action":""},null,8,["show","onSelect","actions","description"])],64)}let ee="",te="",oe="",ne="",ae="local";function le(e){if(console.log("filesPath ",te),!e)return"";if(!e.startsWith("file://"))return e;if(e.startsWith(te)||e.startsWith(oe))return e;let t=e.substring(e.indexOf(ae));return-1!=e.indexOf("/files/")?(console.log("filesPath + url ",te+e),e=te+t):(console.log("cachePath + url ",oe+e),e=oe+t),e}function ie(e){if(-1!=e.lastIndexOf(".")){let t=e.substring(e.lastIndexOf(".")),o=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."));return o=decodeURI(o),{path:e.substring(0,e.lastIndexOf("/")),name:o,ext:t,mimeType:ce(t)}}return{path:e,name:e,ext:"",mimeType:""}}function ce(e){switch(e){case".jpg":case".jpeg":case".png":case".gif":return"image/jpeg";case".doc":return"application/msword";case".docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case".xls":return"application/vnd.ms-excel";case".xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case".ppt":return"application/vnd.ms-powerpoint";case".pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case".pdf":return"application/pdf";case".txt":return"text/plain";case".mp4":return"video/mp4";case".mp3":return"audio/mpeg";case".zip":return"application/zip";case".rar":return"application/x-rar-compressed";case".7z":return"application/x-7z-compressed";case".html":return"text/html";case".css":return"text/css";case".js":return"text/javascript";case".json":return"application/json";case".xml":return"text/xml";case".png":return"image/png";case".jpg":return"image/jpeg";case".jpeg":return"image/jpeg";case".gif":return"image/gif";case".svg":return"image/svg+xml";case".equb":return"application/application/epub+zip";case".apk":return"application/vnd.android.package-archive";default:return"application/octet-stream"}}document.addEventListener("deviceready",(function(){ee="browser"===window.cordova.platformId?"":cordova.file.externalRootDirectory,te="browser"===window.cordova.platformId?"":cordova.file.externalDataDirectory,oe="browser"===window.cordova.platformId?"":cordova.file.externalCacheDirectory,ne=te+ae+"/"}),!1);var se=o(2269),re=o.n(se),ue="";function de(e){return new Promise(((t,o)=>{ue.checkPermission(ue.WRITE_EXTERNAL_STORAGE,(function(n){n.hasPermission?fe(e,t,o):ue.requestPermission(ue.WRITE_EXTERNAL_STORAGE,(n=>{n.hasPermission?fe(e,t,o):o("获取写入权限失败")}),(e=>{o(JSON.stringify(e))}))}))}))}function fe(e,t,o){window.resolveLocalFileSystemURL(ee,(function(n){n.isDirectory&&n.getDirectory("Pictures",{create:!0},(n=>{n.getDirectory("notepictures",{create:!0},(n=>{let a=(new Date).getTime();n.getFile("note_cut_"+a+".jpg",{create:!0},(function(n){n.createWriter((function(a){a.onwriteend=function(){console.log("写入文件成功"),console.log(JSON.stringify(n)),t(n)},a.onerror=function(e){console.error("写入文件失败："+e.toString()),o("写入文件失败："+e.toString())},a.write(e)}))}),(function(e){console.log("出错1",JSON.stringify(e)),o("出错1"+JSON.stringify(e))}))}))}))}),(function(e){console.log("出错2",JSON.stringify(e)),o("出错2"+JSON.stringify(e))}))}function he(e,t,o,n){return console.log("fromFileURL",e),console.log("toParentDirectURL",t),console.log("newFolder",o),console.log("newName",n),new Promise(((a,l)=>{window.resolveLocalFileSystemURL(t,(t=>{console.log("dirEntry ",t.toURL(),"isDirectory",t.isDirectory),t.getDirectory(o,{create:!0},(t=>{window.resolveLocalFileSystemURL(e,(function(o){o.isFile?o.copyTo(t,n,(e=>{console.log("copy success :",e.nativeURL),a(e)}),(e=>{console.log("copy err",JSON.stringify(e)),l("copy err",JSON.stringify(e))})):console.log("fromFileURL: ",e," isFile:false")}),(function(e){console.log("fromFileURL出错2",JSON.stringify(e)),l("fromFileURL出错2"+JSON.stringify(e))}))}),(e=>{console.log("create newFolder error",JSON.stringify(e)),l("create newFolder error:"+JSON.stringify(e))}))}),(e=>{console.log("err",JSON.stringify(e),"toParentDirectURL:",t),l(JSON.stringify(e))}))}))}function ge(e){return new Promise(((t,o)=>{window.resolveLocalFileSystemURL(oe,(n=>{n.getDirectory(ae,{create:!0},(n=>{let a="",l="";l=e.indexOf("?")>-1?e.substring(0,e.indexOf("?")):e,l.endsWith(".jpg")||l.endsWith(".jpeg")||l.endsWith(".png")||l.endsWith(".gif")?a=l.substring(l.lastIndexOf("/")+1):(a=be(e),a="image_note_"+a+".jpg"),n.getFile(a,{create:!0},(n=>{console.log("axios url ",e),console.log("local path ",n.toURL()),Downresource.fetchFromURL(e,n.toURL(),0,(e=>{console.log("res",e),t(n.toURL())}),(e=>{console.log("err",e),o(e)}))}))}))}))}))}function be(e){var t,o,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)o=e.charCodeAt(t),n=(n<<5)-n+o,n|=0;return n}document.addEventListener("deviceready",(function(){ue="browser"===window.cordova.platformId?"":cordova.plugins.permissions}),!1);let me=(e,t,o)=>new Promise(((n,a)=>{console.log("2 y,height",t,o);let l=document.createElement("canvas");l.width=4*e.clientWidth+100,l.height=o,re()(e,{canvas:l,allowTaint:!0,backgroundColor:"#fff",useCORS:!0,imageTimeout:15e3,scale:4,y:t/4}).then((e=>{n(e)})).catch((e=>{a(e)}))}));function pe(e){return new Promise(((t,o)=>{try{let n=3e4,a=4*e.scrollHeight,l=[];if(n>a)l.push(a);else{let e=a%n,t=Math.floor(a/n);for(let o=0;o<t;o++)l.push(n);l.push(e)}console.log("heightArr",JSON.stringify(l));let i=[];for(let t=0;t<l.length;t++){let o=me(e,t*n,l[t]);i.push(o)}console.log("funcArr num ",i.length),Promise.all(i).then((e=>{if(e.length>0){var l=document.createElement("canvas");l.width=e[0].width,l.height=a;var i=l.getContext("2d");for(let t=0;t<e.length;t++)i.drawImage(e[t],0,t*n,e[t].width,e[t].height);l.toBlob((e=>{de(e).then((e=>{t(e)})).catch((e=>{o(e)}))}),"image/jpeg",1)}})).catch((e=>{console.log("err",e),o(e)}))}catch(n){o(n)}}))}function ve(e,t,o){return new Promise(((n,a)=>{e.startsWith("file://")?window.resolveLocalFileSystemURL(e,(function(e){var l=o;l||(l="Download"+(new Date).getTime()+".jpg"),t||(t="Pictures"),he(e.toURL(),ee,t,l).then((e=>{console.log("camera copy file address success:",e.toURL()),n(e.toURL())})).catch((e=>{console.log("camera copy file address error:",JSON.stringify(e)),a(e)}))})):window.resolveLocalFileSystemURL(ee,(l=>{var i=o;i||(i="Download"+(new Date).getTime()+".jpg"),t||(t="Pictures"),l.getDirectory(t,{create:!0},(t=>{t.getFile(i,{create:!0},(t=>{console.log("axios url ",e),console.log("local path ",t.toURL()),Downresource.fetchFromURL(e,t.toURL(),0,(e=>{console.log("res",e),n(t.toURL())}),(e=>{console.log("err",e),a(e)}))}))}))}))}))}function ye(){return new Promise(((e,t)=>{fileChooser.open((o=>{window.FilePath.resolveNativePath(o,(function(t){e(t)}),(function(e){t(e)}))}),(e=>{t(e)}))}))}function we(e){let t=ie(e);return console.log("mimetype:",t.mimeType),new Promise(((o,n)=>{cordova.plugins.fileOpener2.showOpenWithDialog(e,t.mimeType,{error:e=>{n(e)},success:e=>{o()}})}))}function Ie(e){return new Promise(((t,o)=>{window.resolveLocalFileSystemURL(e,(function(e){e.remove((function(){console.log("delete success"),t()}),(function(e){console.error(e),o(e)}),(function(e){console.log("file not exist"),o(e)}))}))}))}function Ne(){return new Promise(((e,t)=>{var o={quality:100,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM,allowEdit:!1,encodingType:Camera.EncodingType.JPEG,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};console.log("调用相册接口"),navigator.camera.getPicture((o=>{console.log("onCameraSuccess:",o),o.startsWith("file://")||(o=`file://${o}`),window.resolveLocalFileSystemURL(o,(function(o){console.log("got file: "+o.toURL()),console.log("got file: "+o.toInternalURL()),he(o.toURL(),te,ae,null).then((t=>{console.log("camera copy file address success:",t.toURL()),e({type:"uri",data:t.toURL()})})).catch((e=>{console.log("camera copy file address error:",JSON.stringify(e)),t(e)}))}),(function(e){console.log("eeee",JSON.stringify(e)),t(e)}))}),(e=>{console.log("onCameraError:",e),t(e)}),o)}))}function Ce(){return new Promise(((e,t)=>{var o={quality:100,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!1,encodingType:Camera.EncodingType.JPEG,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};console.log("调用相册接口"),navigator.camera.getPicture((o=>{console.log("onCameraSuccess:",o),o.startsWith("file://")||(o=`file://${o}`),window.resolveLocalFileSystemURL(o,(function(o){console.log("got file: "+o.toURL()),console.log("got file: "+o.toInternalURL()),he(o.toURL(),te,ae,null).then((t=>{console.log("camera copy file address success:",t.toURL()),e({type:"uri",data:t.toURL()})})).catch((e=>{console.log("camera copy file address error:",JSON.stringify(e)),t(e)}))}),(function(e){console.log("eeee",JSON.stringify(e)),t(e)}))}),(e=>{console.log("onCameraError:",e),t(e)}),o)}))}function Se(){return new Promise(((e,t)=>{var o={quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM,allowEdit:!1,encodingType:Camera.EncodingType.JPEG,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};console.log("调用相册接口"),navigator.camera.getPicture((t=>{e({type:"base64",data:t})}),(e=>{console.log("onCameraError:",e),t(e)}),o)}))}var xe={name:"RichText",props:{value:{type:Object,default:()=>({val:"",type:"0"})},editable:{type:Boolean,default:()=>!0}},emits:{getValue:null,invokeMethod:null},setup(e,t){const o=(0,m.oR)(),n=((0,b.tv)(),(0,g.iH)(null));(0,s.YP)((()=>e.value),((e,t)=>{var o={};if("0"==e.type){n.value.innerHTML=e.val;let t=document.getElementById("richTextID").getElementsByTagName("img");if(console.log("imgs length ",t.length),t.length>0&&!K.value){let e=0;for(let o=0;o<t.length;o++){const n=t[o];let a=n.src;a.startsWith("file://")&&(a=le(a),a!=n.src&&(n.src=a,e++))}e>0&&(o={changeInputCheck:!0})}k(o)}}),{deep:!0});const a=(0,g.iH)(!1),l=(0,g.iH)([]),i=(0,g.iH)(0),c=(0,g.iH)(0),r=e=>{i.value=e},u=e=>{d.value=!0},d=(0,g.iH)(!1),f=[{name:"下载图片"},{name:"其他应用打开"}],h=()=>{},p=(e,t)=>{if(console.log("action",e,"index",t),0==t){let e=l.value[i.value];console.log("down url:",e),ve(e).then((e=>{console.log("download image:",e),v.FN.success("下载成功")})).catch((e=>{console.log("download image err:",e),v.FN.fail("下载失败")}))}else if(1==t){let e=l.value[i.value];we(e).then((()=>{console.log("open file success")})).catch((e=>{console.log("open file fail",e),(0,v.FN)("open file fail"+e)}))}},y=(0,g.iH)(!1),w=[{name:"其他应用打开"},{name:"编辑文件名"},{name:"下载文件"},{name:"删除文件"}],I=(0,g.iH)("文件操作"),N=(0,g.iH)(!1),C=(0,g.iH)(null),S=(e,t)=>{if(0==t)console.log("open file"),we(A.value).then((()=>{console.log("open file success")})).catch((e=>{console.log("open file fail",e),(0,v.FN)("open file fail"+e)}));else if(1==t)N.value=!0,O.value=!0;else if(2==t){console.log("download file");var o="",n=ie(A.value);o=R.value.endsWith(n.ext)?R.value:R.value+n.ext,ve(A.value,"Documents",o).then((e=>{console.log("download file:",e),v.FN.success("下载成功")})).catch((e=>{console.log("download file err:",e),v.FN.fail("下载失败")}))}else 3==t&&(console.log("delete file"),(0,F.WD)({title:"提示",message:"确定要删除该文件吗？"}).then((async()=>{Ie(A.value).then((()=>{C.value.parentNode.removeChild(C.value),k({changeInputCheck:!0}),v.FN.success("删除成功")})).catch((e=>{console.log("delete file err:",e),v.FN.fail("删除失败")}))})).catch((()=>{})))},x=e=>{if("checkbox"==e.target.className){console.log("checked");const t=e.target.parentNode;console.log("parent",t);const o=t.children;let n=0;for(let e=0;e<o.length;e++){const t=o[e];if("checkbox"==t.type&&n++,n>1)break}if(e.target.checked)e.target.setAttribute("checked",!0),1==n&&(t.className+=" checkdivChecked");else{e.target.removeAttribute("checked");let o=t.className,n=o.split(" "),a=n.indexOf("checkdivChecked");-1!=a&&(n.splice(a,1),t.className=n.join(" "))}k({changeInputCheck:!0})}else if(K.value||"img"!=e.target.localName)if(K.value||"uploadfile"!=e.target.className){if(!K.value&&"appUrl"==e.target.className){var o=e.target.getAttribute("data-Id");console.log("click appUrl :",o),t.emit("invokeMethod",{typ:"appUrl",param:{noteId:o}})}}else A.value=e.target.getAttribute("data-path"),console.log("data-path",A.value),I.value=e.target.innerText,U.value=e.target.innerText,R.value=e.target.innerText,C.value=e.target,y.value=!0;else{var n=e.target.src;console.log("imgsrc",n);let t=[],o=document.getElementById("richTextID").getElementsByTagName("img"),s=0;for(let e=0;e<o.length;e++){const a=o[e];console.log("img",a," compare:",a.src==n),a.src==n&&(s=e),t.push(a.src)}l.value=t,i.value=s,c.value=s,console.log("previewIndex",i.value),a.value=!0}},T=e=>{console.log(e),t.emit("getValue",{html:e.target.innerHTML,text:e.target.innerText})},k=e=>{var o={html:n.value.innerHTML,text:n.value.innerText};e&&(o=Object.assign({},o,e)),t.emit("getValue",o);let a=document.getElementById("richTextID").getElementsByTagName("img");if(a.length>0)for(let t=0;t<a.length;t++){const e=a[t];if(e.src.startsWith("http://")||e.src.startsWith("https://"))ge(e.src).then((t=>{console.log("res",t),e.setAttribute("data-source-url",e.src),e.src=t}));else if(e.src.startsWith("data:image/")||e.src.startsWith("file://")){let t=e.getAttribute("data-source-url");t&&ge(t).then((t=>{console.log("res",t),e.src!=t&&(e.src=t)}))}}},D=(0,g.iH)(!1),L=(0,g.iH)(""),_=()=>{if(console.log("linkUrl",L.value),L.value.trim().length>0){j();const n=window.getSelection();if(n.rangeCount>0){if(console.log("恢复选择文本了"),L.value.startsWith("appnote:Id")){var e=L.value.replace("appnote:Id=",""),t=`<div class="appUrl" style="color: #1989fa;text-decoration: underline;margin: 13px 6px;" data-Id="${e}">${n.toString()}</div>`;document.execCommand("insertHTML",!1,t)}else document.execCommand("CreateLink",!1,L.value);k()}else if(L.value.startsWith("appnote:Id")){e=L.value.replace("appnote:Id=","");o.dispatch("getNoteById",e).then((t=>{const o=t;var n=o.Title,a=`<div class="appUrl" style="color: #1989fa;text-decoration: underline;margin: 13px 6px;" data-Id="${e}">${n}</div>`;document.execCommand("insertHTML",!1,a),k()})).catch((e=>{(0,v.FN)("err copy url")}))}}else(0,v.FN)("请输入超链接地址")},P=(0,g.iH)(!1),H=(0,g.iH)(""),O=(0,g.iH)(!1),U=(0,g.iH)(""),R=(0,g.iH)(""),A=(0,g.iH)(""),W=()=>{if(console.log("editFileName",R.value),R.value.trim().length>0)if(N.value){N.value=!1;t=ie(A.value);R.value.endsWith(t.ext)?C.value.innerText=R.value:C.value.innerText=R.value+t.ext,O.value=!1;var e={changeInputCheck:!0};k(e)}else{var t=ie(A.value),o="upload_file_"+(new Date).getTime();he(A.value,te,"document"+t.ext,o+t.ext).then((e=>{console.log("copyFile",e.toURL()),n.value.focus(),j();var o=`<div class="uploadfile" style="color: #1989fa;text-decoration: underline;margin: 13px 6px;" data-path="${e.toURL()}">${R.value}${t.ext}</div>`;document.execCommand("insertHTML",!1,o),document.execCommand("insertHTML",!1,"<br/>"),O.value=!1,k()})).catch((e=>{console.log("err",e),(0,v.FN)("上传文件失败")}))}else(0,v.FN)("请输入文件名")},M=e=>{if("B"==e)document.execCommand("Bold",!1,null),k();else if("U"==e)document.execCommand("Underline",!1,null),k();else if("I"==e)document.execCommand("Italic",!1,null),k();else if("L"==e)L.value="",D.value=!0,Y();else if("A"==e)document.execCommand("ForeColor",!1,"#ff4d4f"),k();else if("AB"==e)document.execCommand("BackColor",!1,"#40a9ff"),k();else if("BList"==e)document.execCommand("insertUnorderedList",!1,null),k();else if("NList"==e)document.execCommand("insertOrderedList",!1,null),k();else if("TODO"==e){var t='<div class="checkdiv"><input type="checkbox" class="checkbox"/></div>';document.execCommand("insertHTML",!1,t),k()}else if("PH"==e)H.value="",P.value=!0,Y();else if("PH2"==e)Y(),Ne().then((e=>{if(console.log(e),"base64"==e.type){var t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="data:image/jpeg;base64,${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}else{t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}})).catch((e=>{console.log(e),(0,v.FN)(e)}));else if("Camera"==e)Y(),Ce().then((e=>{if(console.log(e),"base64"==e.type){var t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="data:image/jpeg;base64,${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}else{t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}})).catch((e=>{console.log(e),(0,v.FN)(e)}));else if("PH3"==e)Y(),Se().then((e=>{if(console.log(e),"base64"==e.type){var t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="data:image/jpeg;base64,${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}else{t=`<div class="photobox" style="width: 100%;"><img class="insertphoto" src="${e.data}" style="width: 100%;"></div>`;document.execCommand("insertHTML",!1,t),document.execCommand("insertHTML",!1,"<br/>")}})).catch((e=>{console.log(e),(0,v.FN)(e)}));else if("Time"==e){var o=q(1);t=`[${o}]`;document.execCommand("insertHTML",!1,t),k()}else"SelFile"==e&&(Y(),ye().then((e=>{console.log(e),A.value=e;var t=ie(e);R.value=t.name,U.value=t.name+t.ext,O.value=!0})).catch((e=>{console.log(e),(0,v.FN)(e)})))};let B=(0,g.iH)(null);const Y=()=>{let e=window.getSelection();console.log(e);let t=e.getRangeAt(0);B.value=t,console.log(t)},j=()=>{var e=window.getSelection();e.removeAllRanges(),e.addRange(B.value)},V=()=>{if(H.value.trim().length>0){console.log("showPicUrlconfirm"),console.log("picUrl",H.value),n.value.focus(),j();var e=`<img src="${H.value}" style="width: 100%;">`;document.execCommand("insertHTML",!1,e),document.execCommand("insertHTML",!1,"<br/>"),k()}else(0,v.FN)("请输入图片地址")},E=e=>{var t=e.target,o=t.querySelectorAll(".checkdiv");if(console.log(o),o.length>0)for(let a=0;a<o.length;a++){const e=o[a];var n=e.querySelector(".checkbox");if(null==n){let t=e.className,o=t.split(" "),n=o.indexOf("checkdivChecked");-1!=n&&(o.splice(n,1),e.className=o.join(" "))}}},J=(e,t)=>{console.log("kd",e);let o=e.startContainer.parentNode,n=o.className.split(" ");if(-1!=n.indexOf("checkdiv")){var a=o.querySelector(".checkbox");if(null!=a){var l=`<div class="checkdiv box${t}"><input type="checkbox" class="checkbox"/></div>`;document.execCommand("insertHTML",!1,l),k(),console.log("add input[checkbox]")}}},z=(0,g.iH)(0),$=e=>{console.log("键盘",e);let t=window.getSelection();console.log(t);let o=t.getRangeAt(0);setTimeout((function(){E(e),J(o,z.value)}),200),z.value=z.value+1},K=(0,g.iH)(e.editable);return{richDiv:n,blurRichText:T,changeFont:M,enterKeydown:$,clickRichText:x,editable:K,showPicUrl:P,showPicUrlconfirm:V,picUrl:H,showLinkUrl:D,linkUrl:L,showLinkUrlconfirm:_,showPreview:a,previewImages:l,previewIndex:i,startPosition:c,onPreviewChange:r,onLongPressEvent:u,onCancelDownPic:h,showDownPic:d,actionsPic:f,selectDownPicSheet:p,showEditFileName:O,selectFileName:U,editFileName:R,onEditFileNameConfirm:W,showFileActionSheet:y,actionsFileItem:w,editFileActionDes:I,selectEditFileSheet:S}}};const Te=(0,w.Z)(xe,[["render",X]]);var ke=Te;const De={name:"AddNoteView",components:{RichText:ke},setup(){const e=(0,m.oR)(),t=(0,b.yj)(),o=(0,b.tv)();(0,s.bv)((()=>{e.commit("SelectTabBar",1),console.log("加载")})),(0,s.Ah)((()=>{e.commit("SelectTabBar",-1),console.log("卸载")})),(0,s.dl)((()=>{console.log("addNote onActivated")}));const n=e=>(e=e??"",e.length>0&&e.length>50&&(e=e.substring(0,50)),e),a=()=>{history.back()},l=e=>{o.push({path:"/ViewNote",query:{Id:e},replace:!0})},i=(0,g.iH)(t.query.State?Number(t.query.State):1),c=()=>{if(D.type="1",0==p.value.trim().length){if(0==w.value.trim().length)return void v.FN.fail("请输入内容");p.value=n(_.value)}if(h.value>0)e.dispatch("updateNote",{Id:h.value,Title:p.value,Category:y.value,Content:w.value,ParentId:C.value,note_category_Id:S.value}).then((e=>{e.rowsAffected>0&&((0,v.FN)("保存成功"),r(h.value))})).catch((e=>{v.FN.fail("保存失败："+e)}));else{const t=new Date,o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();e.dispatch("addNote",{Id:h.value,Title:p.value,Category:y.value,Content:w.value,CreateTime:I.value,Year:o,Month:n,Day:a,timestamp:Date.now(),State:i.value,ParentId:C.value,note_category_Id:S.value}).then((t=>{console.log(JSON.stringify(t)),t.rowsAffected>0&&((0,v.FN)("添加成功"),h.value=t.insertId,e.commit("setRefreshListState",!0),r(h.value))})).catch((e=>{v.FN.fail("添加失败："+e)}))}},r=e=>{setTimeout((()=>{x.value&&x.value>0||L.value&&L.value>0?l(e):a()}),500)},{height:u}=(0,H.iP)(),d=(0,g.iH)(),f=(0,g.iH)(u.value-94+"px"),h=(0,g.iH)(t.query.Id??0),p=(0,g.iH)(""),y=(0,g.iH)("未分类"),w=(0,g.iH)(""),I=(0,g.iH)(q()),N=(0,g.iH)("添加笔记"),C=(0,g.iH)(0),S=(0,g.iH)(0),x=(0,g.iH)(t.query.aId??0),T=(0,g.iH)(t.query.CyId??0),k=(0,g.iH)(t.query.NCId??0),D=(0,g.qj)({val:"",type:"0"});console.log("Id.value",h.value),h.value&&h.value>0&&(N.value="编辑笔记",(0,$.di)("加载中..."),e.dispatch("getNoteById",h.value).then((e=>{const t=e;p.value=t.Title,y.value=t.Category,w.value=t.Content,D.val=t.Content,I.value=t.CreateTime,C.value=t.ParentId,S.value=t.note_category_Id,(0,$.yg)()})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)})));const L=(0,g.iH)(t.query.cpId??0);L.value&&L.value>0&&(N.value="添加笔记",(0,$.di)("加载中..."),e.dispatch("getNoteById",L.value).then((e=>{const t=e;p.value="[复制] "+t.Title,y.value=t.Category,w.value=t.Content,D.val=t.Content,I.value=t.CreateTime,C.value=t.ParentId,S.value=t.note_category_Id,(0,$.yg)()})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)}))),x.value&&x.value>0&&e.dispatch("getNoteById",x.value).then((e=>{const t=e;y.value=t.Category,C.value=t.ParentId,S.value=t.note_category_Id})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)})),T.value&&T.value>0&&e.dispatch("getNoteById",T.value).then((e=>{const t=e;y.value=t.Title+"/未分类",C.value=t.Id,S.value=0})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)})),k.value&&k.value>0&&e.dispatch("getCategoryById",k.value).then((e=>{const t=e;y.value=t.Title+"/"+t.CName,C.value=t.note_Id,S.value=t.Id})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)}));const _=(0,g.iH)(""),P=e=>{console.log(e.text,e.html),w.value=e.html,_.value=e.text},F=()=>{e.dispatch("getCyNoteList").then((e=>{var t=e;console.log("getCyNoteList=>"+JSON.stringify(t));for(let n=0;n<t.length;n++){var o=t[n];R.value.push({text:o.Title,value:o.Id,children:[]})}}))};F();const O=(0,g.iH)(!1),U=(0,g.iH)(""),R=(0,g.iH)([{text:"未分类",value:0,children:[{text:"未分类",value:0}]}]),A=({value:t})=>{(0,$.di)("加载中..."),e.dispatch("getCategoryList",{CyNoteId:t}).then((e=>{var o=e;console.log("getCategoryList=>"+JSON.stringify(o));let n=[];for(let a=0;a<R.value.length;a++){const e=R.value[a];if(e.value==t){n=e.children,t>0&&(n.length=0,n.push({value:0,text:"未分类"}));break}}for(let t=0;t<o.length;t++)n.push({value:o[t].Id,text:o[t].CName});(0,$.yg)()}))},W=({selectedOptions:e})=>{O.value=!1,console.log("selectedOptions",JSON.stringify(e)),y.value=e.map((e=>e.text)).join("/");var t=e.map((e=>e.value)).join(" "),o=t.split(" ");C.value=Number(o[0]),S.value=Number(o[1]),0==C.value&&(y.value=y.value.split("/")[0])};return{getValue:P,onClickLeft:a,onClickRight:c,PageTitle:N,title:p,categoryName:y,content:w,tmepContent:D,createTime:I,root:d,vheight:f,Id:h,showPopup:O,options:R,onChange:A,onFinish:W,cascaderValue:U}}},Le=()=>{(0,c.sj)((e=>({f55871d8:e.vheight})))},_e=De.setup;De.setup=_e?(e,t)=>(Le(),_e(e,t)):Le;var Pe=De;const Fe=(0,w.Z)(Pe,[["render",V]]);var He=Fe;const Oe={class:"content",ref:"root"},Ue={class:"category-name"},Re={class:"note-content",ref:"noteContent"},Ae={class:"menutitle"},We={class:"menubox",ref:"menuRef"},Me={style:{"text-align":"left","font-size":"14px"}},Be=(0,s.Uk)("添加笔记");function Ye(e,t,o,n,a,l){const i=(0,s.up)("van-icon"),r=(0,s.up)("van-nav-bar"),u=(0,s.up)("van-cell"),d=(0,s.up)("rich-text"),f=(0,s.up)("van-action-sheet"),h=(0,s.up)("van-row"),g=(0,s.up)("van-button"),b=(0,s.up)("van-swipe-cell"),m=(0,s.up)("van-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{title:n.PageTitle,"left-text":"返回","left-arrow":"",onClickLeft:n.onClickLeft,onClickRight:n.onClickRight},{right:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"ellipsis",size:"25"})])),_:1},8,["title","onClickLeft","onClickRight"]),(0,s._)("div",Oe,[(0,s.Wm)(u,{class:"date-info",title:n.createTime,"onUpdate:title":t[0]||(t[0]=e=>n.createTime=e)},{"right-icon":(0,s.w5)((()=>[(0,s._)("label",Ue,(0,C.zw)(n.categoryName),1)])),_:1},8,["title"]),(0,s._)("div",{class:"leftMenu",onClick:t[1]||(t[1]=(...e)=>n.openMenu&&n.openMenu(...e))},[(0,s.Wm)(i,{name:"arrow-left"})]),(0,s._)("div",Re,[(0,s.Wm)(d,{onGetValue:n.getValue,onInvokeMethod:n.goDetail,value:n.tmepContent,editable:!1},null,8,["onGetValue","onInvokeMethod","value"])],512)],512),(0,s.Wm)(f,{show:n.showSheet,"onUpdate:show":t[2]||(t[2]=e=>n.showSheet=e),onSelect:n.selectSheet,actions:n.actionsSheet,"cancel-text":"取消","close-on-click-action":"",onCancel:n.onCancel},null,8,["show","onSelect","actions","onCancel"]),(0,s.Wm)(m,{show:n.showRightMenu,"onUpdate:show":t[3]||(t[3]=e=>n.showRightMenu=e),position:"right",style:{width:"80%",height:"100%"}},{default:(0,s.w5)((()=>[(0,s._)("p",Ae,(0,C.zw)(n.categoryName),1),(0,s._)("div",We,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.listMenu,((e,t)=>((0,s.wg)(),(0,s.j4)(b,{key:t},{right:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(g,{square:"",type:"default",text:"上移",onClick:e=>n.upmove(0,t)},null,8,["onClick"]),[[c.F8,0!=t]]),(0,s.wy)((0,s.Wm)(g,{square:"",type:"default",text:"下移",onClick:e=>n.upmove(1,t)},null,8,["onClick"]),[[c.F8,t!=e.len]])])),default:(0,s.w5)((()=>[(0,s.Wm)(h,{onClick:t=>n.openOtherNoteDetail(e.Id),class:(0,C.C_)(["vrow",1==e.select?"cur":""])},{default:(0,s.w5)((()=>[(0,s._)("p",Me,(0,C.zw)(e.name),1)])),_:2},1032,["onClick","class"])])),_:2},1024)))),128))],512),(0,s.Wm)(g,{type:"default",onClick:n.addNote,style:{width:"80%",margin:"20px auto 0px"},block:""},{default:(0,s.w5)((()=>[Be])),_:1},8,["onClick"])])),_:1},8,["show"])],64)}function je(e){return new Promise(((t,o)=>{cordova.plugins.clipboard.copy(e,(function(){t()}),(function(e){o(e)}))}))}const Ve={name:"ViewNoteView",components:{RichText:ke},setup(){const e=(0,m.oR)(),t=(0,b.yj)(),o=(0,b.tv)();(0,s.bv)((()=>{e.commit("SelectTabBar",1),console.log("加载")})),(0,s.Ah)((()=>{e.commit("SelectTabBar",-1),console.log("卸载")})),(0,s.dl)((()=>{console.log("addNote onActivated")})),(0,s.ic)((()=>{console.log("addNote onUpdated",f.value,"route.query.Id",t.query.Id);var e=t.query.Id;console.log("addNote onUpdated after",e),e&&(document.querySelector(".richText").scrollTop=0,T(e))}));const n=()=>{history.back()},a=()=>{_.value=!0},l=(0,g.iH)(!1),i=[{text:"生活",icon:"add-o"},{text:"工作",icon:"music-o"},{text:"旅游",icon:"more-o"}],c=e=>{p.value=e.text},{height:r}=(0,H.iP)(),u=(0,g.iH)(),d=(0,g.iH)(r.value-92+"px"),f=(0,g.iH)(t.query.Id??0),h=(0,g.iH)(""),p=(0,g.iH)("未分类"),y=(0,g.iH)(""),w=(0,g.iH)(q()),I=(0,g.iH)("详情"),N=(0,g.iH)(0),C=(0,g.iH)(0),S=(0,g.qj)({val:"",type:"0"}),x=(0,g.iH)(0),T=t=>{(0,$.di)("加载中..."),e.dispatch("getNoteById",t).then((e=>{const t=e;h.value=t.Title,I.value=t.Title,p.value=t.Category,y.value=t.Content,S.val=t.Content,w.value=t.CreateTime,N.value=t.ParentId,C.value=t.note_category_Id,x.value=t.State,(0,$.yg)(),A.value=!1})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)}))};f.value&&T(f.value);const k=(0,g.iH)(""),D=t=>{console.log(t.text,t.html),y.value=t.html,k.value=t.text,t.changeInputCheck&&e.dispatch("updateNote",{Id:f.value,Title:h.value,Category:p.value,Content:y.value,ParentId:N.value,note_category_Id:C.value}).then((e=>{e.rowsAffected})).catch((e=>{v.FN.fail("保存失败："+e)}))},L=e=>{if("appUrl"==e.typ){var t=e.param.noteId;console.log("goDetail ",t),o.push({path:"/ViewNote",query:{Id:t,date:(new Date).getTime()}}),f.value=t,document.querySelector(".richText").scrollTop=0,T(t)}},_=(0,g.iH)(!1),P=[{name:"编辑笔记"},{name:"复制编辑"},{name:"复制链接"},{name:"笔记截图"},{name:"删除笔记",color:"red"}],O=()=>console.log("取消"),U=(0,g.iH)(null),R=(t,n)=>{if(console.log(t,n),0==n)o.push({path:"/AddNote",query:{Id:f.value}});else if(1==n)o.push({path:"/AddNote",query:{cpId:f.value,State:x.value},replace:!0});else if(2==n){var a="appnote:Id="+f.value;je(a).then((()=>{v.FN.success("复制成功")})).catch((e=>{v.FN.fail("复制失败!"+e)}))}else if(3==n){console.log("笔记截图");const e=document.getElementById("richTextID");console.log("el.scrollHeight",e.scrollHeight),console.log("el.clientWidth",e.clientWidth),(0,$.di)("截图中..."),pe(e).then((e=>{(0,$.yg)(),v.FN.success("截图已保存")})).catch((e=>{(0,$.yg)(),console.log("截图失败："+JSON.stringify(e)),v.FN.fail("截图失败："+JSON.stringify(e))}))}else 4==n&&(0,F.WD)({title:"确认删除该笔记？"}).then((()=>{console.log("shanchu biji "),e.dispatch("delNote",{Id:f.value,real:1}).then(((t,o)=>{t.rowsAffected>0?(v.FN.fail("删除成功"),e.commit("setRefreshListState",!0),setTimeout((function(){history.back()}),400)):v.FN.fail("移出失败："+o)})).catch((e=>{console.log(e)}))})).catch((()=>{}))},A=(0,g.iH)(!1),W=()=>{A.value=!0,C.value>0&&Y(C.value)},M=(0,g.iH)([]),B=(0,g.iH)(null),Y=t=>{M.value.length=0,(0,$.di)("加载中..."),e.dispatch("getNoteList",{note_category_Id:t}).then((e=>{var t=e;console.log("getNoteList=>"+JSON.stringify(t));let o=t.length-1,n=0;for(let l=0;l<t.length;l++){var a=0;t[l].Id==f.value&&(a=1,n=l+1),M.value.push({Id:t[l].Id,name:t[l].Title,timestamp:t[l].Timestamp,select:a,len:o})}setTimeout((()=>{var e=document.querySelector(".vrow").clientHeight+1;n*=e,console.log("vrow height",e);var t=B.value.clientHeight;console.log("selectheight",n,"menuClientHeight",t),B.value.scrollTop=n-t+t/2}),100),(0,$.yg)()}))},j=(t,o)=>{var n=0,a=0,l=0,i=0;0==t?(n=M.value[o].Id,a=M.value[o-1].timestamp,l=M.value[o-1].Id,i=M.value[o].timestamp):(n=M.value[o].Id,a=M.value[o+1].timestamp,l=M.value[o+1].Id,i=M.value[o].timestamp),e.dispatch("updateNoteTimestamp",{Id:n,timestamp:a}).then((t=>{t.rowsAffected>0&&e.dispatch("updateNoteTimestamp",{Id:l,timestamp:i}).then((e=>{e.rowsAffected>0&&Y(C.value)})).catch((e=>{v.FN.fail("保存失败："+e)}))})).catch((e=>{v.FN.fail("保存失败："+e)}))},V=e=>{o.push({path:"/ViewNote",query:{Id:e},replace:!0}),f.value=e,document.querySelector(".richText").scrollTop=0,T(e)},E=()=>{o.push({path:"/AddNote",query:{Id:0,aId:f.value,State:0},replace:!0})};return{getValue:D,onClickLeft:n,onClickRight:a,PageTitle:I,title:h,categoryName:p,content:y,tmepContent:S,createTime:w,actions:i,showPopover:l,onSelect:c,root:u,vheight:d,Id:f,showSheet:_,actionsSheet:P,onCancel:O,selectSheet:R,noteContent:U,openMenu:W,showRightMenu:A,listMenu:M,upmove:j,openOtherNoteDetail:V,addNote:E,menuRef:B,goDetail:L}}},qe=()=>{(0,c.sj)((e=>({"784d6ee3":e.vheight})))},Ee=Ve.setup;Ve.setup=Ee?(e,t)=>(qe(),Ee(e,t)):qe;var Je=Ve;const ze=(0,w.Z)(Je,[["render",Ye]]);var $e=ze;function Ke(e,t,o,n,a,l){const i=(0,s.up)("van-nav-bar"),r=(0,s.up)("van-icon"),u=(0,s.up)("van-calendar"),d=(0,s.up)("notes-view"),f=(0,s.up)("van-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,{title:"日历",onClickRight:n.clickRightEvent},null,8,["onClickRight"]),(0,s.Wm)(u,{"show-title":!1,"show-subtitle":!1,color:"#1989fa","min-date":n.minDate,"max-date":n.maxDate,poppable:!1,"show-confirm":!1,formatter:n.formatter,onSelect:n.SelectDate,onMonthShow:n.monthShow},{"top-info":(0,s.w5)((e=>[(0,s.wy)((0,s.Wm)(r,{class:"tips",color:"red",name:"bookmark"},null,512),[[c.F8,e.topInfo>0]])])),_:1},8,["min-date","max-date","formatter","onSelect","onMonthShow"]),(0,s.Wm)(f,{show:n.showPopup,"onUpdate:show":t[0]||(t[0]=e=>n.showPopup=e),onClickOverlay:n.cancelPop,position:"bottom",style:{height:"80%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{Date:n.DateObj,IsAll:!0,ShowNavBar:!1,onOpenNotedetail:n.openNotedetail},null,8,["Date","onOpenNotedetail"])])),_:1},8,["show","onClickOverlay"])],64)}const Ze={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,92821,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],festival:{"1-1":{title:"元旦节"},"2-14":{title:"情人节"},"5-1":{title:"劳动节"},"5-4":{title:"青年节"},"6-1":{title:"儿童节"},"9-10":{title:"教师节"},"10-1":{title:"国庆节"},"12-25":{title:"圣诞节"},"3-8":{title:"妇女节"},"3-12":{title:"植树节"},"4-1":{title:"愚人节"},"5-12":{title:"护士节"},"7-1":{title:"建党节"},"8-1":{title:"建军节"},"12-24":{title:"平安夜"}},lFestival:{"12-30":{title:"除夕"},"1-1":{title:"春节"},"1-15":{title:"元宵节"},"2-2":{title:"龙抬头"},"5-5":{title:"端午节"},"7-7":{title:"七夕节"},"7-15":{title:"中元节"},"8-15":{title:"中秋节"},"9-9":{title:"重阳节"},"10-1":{title:"寒衣节"},"10-15":{title:"下元节"},"12-8":{title:"腊八节"},"12-23":{title:"北方小年"},"12-24":{title:"南方小年"}},getFestival(){return this.festival},getLunarFestival(){return this.lFestival},setFestival(e={}){this.festival=e},setLunarFestival(e={}){this.lFestival=e},solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){let t,o=348;for(t=32768;t>8;t>>=1)o+=this.lunarInfo[e-1900]&t?1:0;return o+this.leapDays(e)},leapMonth:function(e){return 15&this.lunarInfo[e-1900]},leapDays:function(e){return this.leapMonth(e)?65536&this.lunarInfo[e-1900]?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;const o=t-1;return 1===o?e%4===0&&e%100!==0||e%400===0?29:28:this.solarMonth[o]},toGanZhiYear:function(e){var t=(e-3)%10,o=(e-3)%12;return 0===t&&(t=10),0===o&&(o=12),this.Gan[t-1]+this.Zhi[o-1]},toAstro:function(e,t){const o="魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯",n=[20,19,21,21,21,22,23,23,23,23,22,22];return o.substr(2*e-(t<n[e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100||t<1||t>24)return-1;const o=this.sTermInfo[e-1900],n=[];for(let a=0;a<o.length;a+=5){const e=parseInt("0x"+o.substr(a,5)).toString();n.push(e[0],e.substr(1,2),e[3],e.substr(4,2))}return parseInt(n[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;let t=this.nStr3[e-1];return t+="月",t},toChinaDay:function(e){let t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,o){let n,a=parseInt(e),l=parseInt(t),i=parseInt(o);if(a<1900||a>2100)return-1;if(1900===a&&1===l&&i<31)return-1;n=a?new Date(a,parseInt(l)-1,i):new Date;let c,s=0,r=0;a=n.getFullYear(),l=n.getMonth()+1,i=n.getDate();let u=(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())-Date.UTC(1900,0,31))/864e5;for(c=1900;c<2101&&u>0;c++)r=this.lYearDays(c),u-=r;u<0&&(u+=r,c--);let d=new Date,f=!1;d.getFullYear()===a&&d.getMonth()+1===l&&d.getDate()===i&&(f=!0);let h=n.getDay(),g=this.nStr1[h];0===h&&(h=7);const b=c;s=this.leapMonth(c);let m=!1;for(c=1;c<13&&u>0;c++)s>0&&c===s+1&&!1===m?(--c,m=!0,r=this.leapDays(b)):r=this.monthDays(b,c),!0===m&&c===s+1&&(m=!1),u-=r;0===u&&s>0&&c===s+1&&(m?m=!1:(m=!0,--c)),u<0&&(u+=r,--c);const p=c,v=u+1,y=l-1,w=this.toGanZhiYear(b),I=this.getTerm(a,2*l-1),N=this.getTerm(a,2*l);let C=this.toGanZhi(12*(a-1900)+l+11);i>=I&&(C=this.toGanZhi(12*(a-1900)+l+12));let S=!1,x=null;I===i&&(S=!0,x=this.solarTerm[2*l-2]),N===i&&(S=!0,x=this.solarTerm[2*l-1]);const T=Date.UTC(a,y,1,0,0,0,0)/864e5+25567+10,k=this.toGanZhi(T+i-1),D=this.toAstro(l,i),L=a+"-"+l+"-"+i,_=b+"-"+p+"-"+v,P=this.festival,F=this.lFestival,H=l+"-"+i;let O=p+"-"+v;return 12===p&&29===v&&29===this.monthDays(b,p)&&(O="12-30"),{date:L,lunarDate:_,festival:P[H]?P[H].title:null,lunarFestival:F[O]?F[O].title:null,lYear:b,lMonth:p,lDay:v,Animal:this.getAnimal(b),IMonthCn:(m?"闰":"")+this.toChinaMonth(p),IDayCn:this.toChinaDay(v),cYear:a,cMonth:l,cDay:i,gzYear:w,gzMonth:C,gzDay:k,isToday:f,isLeap:m,nWeek:h,ncWeek:"星期"+g,isTerm:S,Term:x,astro:D}},lunar2solar:function(e,t,o,n){e=parseInt(e),t=parseInt(t),o=parseInt(o),n=!!n;const a=this.leapMonth(e);if(n&&a!==t)return-1;if(2100===e&&12===t&&o>1||1900===e&&1===t&&o<31)return-1;const l=this.monthDays(e,t);let i=l;if(n&&(i=this.leapDays(e,t)),e<1900||e>2100||o>i)return-1;let c,s=0;for(c=1900;c<e;c++)s+=this.lYearDays(c);let r=0,u=!1;for(c=1;c<t;c++)r=this.leapMonth(e),u||r<=c&&r>0&&(s+=this.leapDays(e),u=!0),s+=this.monthDays(e,c);n&&(s+=l);const d=Date.UTC(1900,1,30,0,0,0),f=new Date(864e5*(s+o-31)+d),h=f.getUTCFullYear(),g=f.getUTCMonth()+1,b=f.getUTCDate();return this.solar2lunar(h,g,b)}},Ge={name:"CalendarView",components:{NotesView:M},setup(){const e=(0,b.tv)(),t=(0,m.oR)(),o=(0,g.iH)("100%"),{height:n}=(0,H.iP)(),a=(0,g.qj)({}),l=async(e,o)=>{const n=await t.dispatch("getNoteListNearMonth",{Year:e,Month:o});console.log("getNoteListNearMonth=>"+JSON.stringify(n));var l=[],i=[],c=[];const s=J(e,o),r=z(e,o);for(let t=0;t<n.length;t++){const a=n[t];a.Year==e&&a.Month==o?l.push(a):a.Year==s.Year&&a.Month==s.Month?i.push(a):a.Year==r.Year&&a.Month==r.Month&&c.push(a)}a[`${e}-${o}`]=l,a[`${s.Year}-${s.Month}`]=i,a[`${r.Year}-${r.Month}`]=c};l((new Date).getFullYear(),(new Date).getMonth()+1),(0,s.bv)((()=>{o.value=n.value-80+"px"}));const i=(0,s.Fl)((()=>e=>{const t=new Date(e.date),o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),l=t.getDay();0!==l&&6!==l||(e.className="weekendRed");const i=Ze.solar2lunar(o,n,a),c=new Date,s=c.getFullYear(),r=c.getMonth()+1,u=c.getDate();return o==s&&n==r&&a==u&&(e.className+=" today"),null!=i.festival&&""!=i.festival?e.bottomInfo=i.festival:null!=i.Term&&""!=i.Term?e.bottomInfo=i.Term:null!=i.IDayCn&&""!=i.IDayCn&&(e.bottomInfo=i.IDayCn),w(e,o,n,a),e})),c=(0,g.iH)(!1),r=(0,g.qj)({Year:0,Month:0,Day:0}),u=e=>{const t=new Date(e),o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();console.log([o,n,a].join("-")),r.Year=o,r.Month=n,r.Day=a,console.log(JSON.stringify(r)),c.value=!0,d()},d=()=>{const e={title:"title",url:"/Calendar"};window.history.pushState(e,e.title,e.url)};window.addEventListener("popstate",(()=>{console.log("popstate"),h.value&&c.value&&(c.value=!1)}),!1);const f=()=>{console.log("cancelPop"),c.value&&e.back()},h=(0,g.iH)(!1);(0,s.dl)((()=>{if(console.log("Cale actived"),h.value=!0,t.commit("SelectTabBar",-1),t.commit("SelectTabBar",-1),0==r.Year){const e=new Date;r.Year=e.getFullYear(),r.Month=e.getMonth()+1,r.Day=e.getDate()}l(r.Year,r.Month),console.log("historyNote",p.value.length),p.value.length>0&&(console.log("showPop",c.value),p.value=[],setTimeout((()=>{c.value=!0}),100))})),(0,s.se)((()=>{console.log("deactived"),h.value=!1}));const p=(0,g.iH)([]),v=e=>{console.log("openNotedetail",JSON.stringify(e)),p.value.push(e.Id)},y=e=>{console.log("monthShow"),console.log(JSON.stringify(e)),l(e.date.getFullYear(),e.date.getMonth()+1)},w=(e,t,o,n)=>{var l=a[`${t}-${o}`];if(l&&l.length>0)for(let a=0;a<l.length;a++){const t=l[a];if(t.Day==n){e.topInfo=1;break}}else e.topInfo=0},I=new Date,N=()=>{console.log("click right")};return{vheight:o,minDate:new Date(I.getFullYear()-3,0,1),maxDate:new Date(I.getFullYear()+3,11,31),formatter:i,SelectDate:u,monthShow:y,showPopup:c,DateObj:r,cancelPop:f,openNotedetail:v,clickRightEvent:N}}},Qe=()=>{(0,c.sj)((e=>({"15d303a8":e.vheight})))},Xe=Ge.setup;Ge.setup=Xe?(e,t)=>(Qe(),Xe(e,t)):Qe;var et=Ge;const tt=(0,w.Z)(et,[["render",Ke]]);var ot=tt;const nt={class:"setting"};function at(e,t,o,n,a,l){const i=(0,s.up)("van-nav-bar"),c=(0,s.up)("van-switch"),r=(0,s.up)("van-cell"),u=(0,s.up)("van-cell-group");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,{title:"设置"}),(0,s._)("div",nt,[(0,s.Wm)(u,{inset:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{title:"开启指纹验证",size:"large"},{"right-icon":(0,s.w5)((()=>[(0,s.Wm)(c,{modelValue:n.switchChecked,"onUpdate:modelValue":[t[0]||(t[0]=e=>n.switchChecked=e),n.onUpdateValue]},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1})])],64)}var lt={name:"SettingView",setup(){const e=(0,m.oR)(),t=(0,g.iH)(!1),o=o=>{console.log("newValue",o),(0,F.WD)({title:"提醒",message:o?"是否开启指纹验证？":"是否关闭指纹验证？"}).then((()=>{t.value=o,e.commit("setLocalItem",{key:e.state.localFingerKey,val:o})})).catch((()=>{t.value=!o}))};(0,s.dl)((()=>{n()}));const n=async()=>{var o=await e.getters.getLocalItem(e.state.localFingerKey);console.log("getLocalItem",o,typeof o),t.value="true"===o};return{switchChecked:t,onUpdateValue:o}}};const it=(0,w.Z)(lt,[["render",at]]);var ct=it;const st={class:"list-header"},rt={class:"list-data"};function ut(e,t,o,n,a,l){const i=(0,s.up)("van-nav-bar"),c=(0,s.up)("van-search"),r=(0,s.up)("van-dropdown-item"),u=(0,s.up)("van-dropdown-menu"),d=(0,s.up)("notes-view");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",st,[(0,s.Wm)(i,{title:"搜索记录","left-text":"返回","left-arrow":"",onClickLeft:n.onClickLeft},null,8,["onClickLeft"]),(0,s.Wm)(c,{modelValue:n.searchKeyword,"onUpdate:modelValue":t[0]||(t[0]=e=>n.searchKeyword=e),onSearch:n.onSearch,placeholder:"请输入搜索关键词"},null,8,["modelValue","onSearch"]),(0,s.Wm)(u,{"active-color":"#ee0a24"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{modelValue:n.selValue1,"onUpdate:modelValue":t[1]||(t[1]=e=>n.selValue1=e),options:n.option1,onChange:n.changeOption1},null,8,["modelValue","options","onChange"]),(0,s.Wm)(r,{modelValue:n.selValue2,"onUpdate:modelValue":t[2]||(t[2]=e=>n.selValue2=e),options:n.option2,onChange:n.changeOption2},null,8,["modelValue","options","onChange"])])),_:1})]),(0,s._)("div",rt,[(0,s.Wm)(d,{ShowNavBar:!1,onOpenNotedetail:n.openNotedetail,Lazyload:n.Lazyload,QueryItem:n.QueryItem,IsAll:!0},null,8,["onOpenNotedetail","Lazyload","QueryItem"])])],64)}var dt={name:"Search",components:{NotesView:M},setup(){const e=(0,m.oR)(),t=(0,b.yj)(),o=(0,b.tv)();(0,s.bv)((()=>{e.commit("SelectTabBar",1),console.log("SelectTabBar加载")})),(0,s.Ah)((()=>{e.commit("SelectTabBar",-1),console.log("SelectTabBar卸载")})),(0,s.dl)((()=>{console.log("onActivated Search"),e.commit("SelectTabBar",1),console.log("route.query.CyId",t.query.CyId)}));const n=()=>{history.back()},a=(0,g.iH)(t.query.lz?Number(t.query.lz):0);console.log("lz",a.value,typeof a.value);const l=(0,g.iH)(1==a.value);console.log(l.value,typeof l.value);const i=(0,g.iH)(t.query.CyId?t.query.CyId:0),c=(0,g.iH)(t.query.CaId?t.query.CaId:-1),r=(0,g.iH)(t.query.kw?t.query.kw:""),u=(0,g.iH)("");u.value=r.value;const d=()=>{f.Keywords=u.value,o.push({path:"/Search",query:{CyId:i.value,CaId:c.value,kw:u.value,lz:1},replace:!0})},f=(0,g.qj)({ParentId:0,note_category_Id:-1,Keywords:""}),h=(0,g.iH)(0),p=(0,g.iH)(-1),v=[{text:"全部知识库",value:0}],y=[{text:"全部分类",value:-1}],w=()=>{e.dispatch("getCyNoteList").then((e=>{var t=e;console.log("getCyNoteList=>"+JSON.stringify(t));for(let n=0;n<t.length;n++){var o=t[n];v.push({text:o.Title+" ("+o.TotalNoteNum+")",value:o.Id,num:o.TotalNoteNum})}i.value||(i.value=0),h.value=Number(i.value),I(h.value)}))};w();const I=t=>{y.length=0,y.push({text:"全部分类",value:-1});let o={text:"未分类",value:0},n=null;if(t>0){y.push(o);for(let e=0;e<v.length;e++){const o=v[e];if(o.value==t){n=o;break}}}e.dispatch("getCategoryList",{CyNoteId:t}).then((e=>{var a=e;console.log("getCategoryList=>"+JSON.stringify(a));let l=0;for(let t=0;t<a.length;t++)l+=a[t].TotalNoteNum,y.push({value:a[t].Id,text:a[t].CName+" ("+a[t].TotalNoteNum+")"});null!=n&&(o.text="未分类("+(n.num-l)+")"),c.value||(c.value=-1),p.value=Number(c.value),f.note_category_Id=Number(c.value),f.ParentId=t,f.Keywords=u.value,0==u.value.trim().length&&(f.Keywords="  ")}))},N=e=>{o.push({path:"/Search",query:{CyId:e,CaId:-1,kw:u.value,lz:1},replace:!0}),i.value=e,c.value=-1,I(e)},C=e=>{o.push({path:"/Search",query:{CyId:i.value,CaId:e,kw:u.value,lz:1},replace:!0}),c.value=e,f.note_category_Id=e},S=e=>{console.log("openNotedetail",JSON.stringify(e))};return{onClickLeft:n,searchKeyword:u,onSearch:d,selValue1:h,selValue2:p,option1:v,option2:y,changeOption1:N,changeOption2:C,QueryItem:f,Lazyload:l,openNotedetail:S}}};const ft=(0,w.Z)(dt,[["render",ut]]);var ht=ft;const gt={class:"list-box-cy"},bt={class:"van-multi-ellipsis--l3"},mt={style:{color:"#999","margin-right":"8px"}},pt={class:"top-tag"};function vt(e,t,o,n,a,l){const i=(0,s.up)("van-icon"),r=(0,s.up)("router-link"),u=(0,s.up)("van-nav-bar"),d=(0,s.up)("van-button"),f=(0,s.up)("van-col"),h=(0,s.up)("van-row"),g=(0,s.up)("van-swipe-cell"),b=(0,s.up)("van-list"),m=(0,s.up)("van-pull-refresh");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.wy)((0,s.Wm)(u,{class:"list-title",title:"知识库"},{right:(0,s.w5)((()=>[n.showSwitchBtn?((0,s.wg)(),(0,s.j4)(r,{key:0,to:"/AddCategory"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"plus",size:"22"})])),_:1})):(0,s.kq)("",!0)])),_:1},512),[[c.F8,n.showNavbar]]),(0,s._)("div",gt,[(0,s.Wm)(m,{class:"van-pull-refresh-cy",modelValue:n.Refresh,"onUpdate:modelValue":t[1]||(t[1]=e=>n.Refresh=e),onRefresh:n.onRefresh},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{loading:n.loading,"onUpdate:loading":t[0]||(t[0]=e=>n.loading=e),finished:n.finished,"finished-text":"没有更多了",onLoad:n.onLoad},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.list,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"before-close":n.beforeClose},(0,s.Nv)({left:(0,s.w5)((()=>[(0,s.Wm)(d,{square:"",type:"primary",style:{height:"100% !important"},text:e.Sort>1?"取消常用":"常用",onClick:t=>n.nextTop(e.Id)},null,8,["text","onClick"])])),default:(0,s.w5)((()=>[(0,s.Wm)(h,{onClick:t=>n.onNoteDetail(e.Id)},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:"24"},{default:(0,s.w5)((()=>[(0,s._)("p",bt,[(0,s.Wm)(i,{name:"bookmark",style:{"margin-right":"5px"},color:"blue"}),(0,s.Uk)((0,C.zw)(e.Title),1)]),(0,s._)("p",null,[(0,s._)("span",mt,"共"+(0,C.zw)(e.totalNotes)+"篇笔记",1),(0,s.Uk)((0,C.zw)(e.CreateTime),1),(0,s.wy)((0,s._)("span",pt,"常用",512),[[c.F8,e.Sort>1]])])])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},[n.showSwitchBtn?{name:"right",fn:(0,s.w5)((()=>[(0,s.Wm)(d,{square:"",style:{height:"100% !important"},text:"编辑",onClick:t=>n.AddCategory(e.Id),type:"success",class:"delete-button"},null,8,["onClick"])]))}:void 0]),1032,["before-close"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1},8,["modelValue","onRefresh"])])],64)}var yt=o(776);const wt={name:"CategoryView",props:{Date:{type:Object,default:()=>({Year:0,Month:0,Day:0})},IsAll:Boolean,Keywords:String,ShowNavBar:{type:Boolean,default:()=>!0}},emits:{openNotedetail:null},setup(e,t){const o=(0,b.tv)(),n=(0,m.oR)(),a=(0,g.iH)(!1),l=(0,g.iH)([]),i=(0,g.iH)(!1),c=(0,g.iH)(!1);var r=0;const u=()=>{setTimeout((()=>{(0,v.FN)("刷新成功"),r=1,l.value=[],console.log("getNoteListByPage5"),N(r,20),a.value=!1}),1e3)},d=()=>{r+=1,console.log("getNoteListByPage6"),N(r,20)};let f=0;const h=(e,t)=>{f=e,console.log(f),(0,F.WD)({title:"是否删除该知识库？"}).then((()=>{t>0?v.FN.fail("知识库有数据不能删除!"):n.dispatch("delNote",{Id:f,real:0}).then(((e,t)=>{if(e.rowsAffected>0){for(let e=0;e<l.value.length;e++){const t=l.value[e];if(t.Id==f){l.value.splice(e,1);break}}(0,yt.NU)({type:"success",message:"删除成功",position:"bottom"})}else v.FN.fail("删除失败："+t)}))})).catch((()=>{}))};let p=0;const y=e=>{p=e,console.log(p)},w=e=>{e.Sort>1?n.dispatch("updateNoteSort",{Id:e.Id,Sort:1}).then((e=>{e.rowsAffected>0&&(r=1,l.value=[],console.log("getNoteListByPage7"),N(r,20),setTimeout((function(){(0,v.FN)("已取消常用")}),300))})).catch((e=>{v.FN.fail("取消常用失败："+e)})):n.dispatch("updateNoteSort",{Id:e.Id,Sort:Date.now()}).then((e=>{e.rowsAffected>0&&(r=1,l.value=[],console.log("getNoteListByPage1"),N(r,20),setTimeout((function(){(0,v.FN)("已设置常用")}),300))})).catch((e=>{v.FN.fail("常用失败："+e)}))},I=({position:e})=>{switch(e){case"left":return new Promise((()=>{for(let e=0;e<l.value.length;e++){const t=l.value[e];if(t.Id==p){w(t);break}}}));case"cell":case"outside":return!0;case"right":return new Promise((()=>{}))}};(0,s.dl)((()=>{n.commit("SelectTabBar",-1);const e=n.state.RefreshListState;console.log("store.state.RefreshListState:"+e,typeof e),e&&(n.commit("setRefreshListState",!1),l.value=[],r=1,console.log("getNoteListByPage2"),N(r,20))})),(0,s.YP)((()=>e.Date),((e,t)=>{console.log(JSON.stringify(e),JSON.stringify(t)),l.value=[],r=1,console.log("getNoteListByPage3"),N(r,20)}),{deep:!0}),(0,s.YP)((()=>e.Keywords),((e,t)=>{console.log(JSON.stringify(e),JSON.stringify(t)),l.value=[],r=1,console.log("getNoteListByPage4"),N(r,20)}),{deep:!0});const N=(t,o)=>{c.value=!1,console.log(t+", "+o+", "+e.Date.Year+", "+e.Date.Month+", "+e.Date.Day+", "+e.Keywords),n.dispatch("getCyNoteListByPage",{pageIndex:t,pageSize:o,Year:e.Date.Year,Month:e.Date.Month,Day:e.Date.Day,State:e.IsAll?0:1,Sort:e.IsAll,kw:e.Keywords}).then((e=>{var t=e;console.log("getCyNoteListByPage=>"+JSON.stringify(t));for(let o=0;o<t.length;o++)l.value.push(t[o]);i.value=!1,0==t.length&&(c.value=!0)}))},C=e=>{o.push({path:"/AddCategory",query:{Id:e}})},S=e=>{o.push({path:"/CategoryDetail",query:{CyId:e}})},x=(0,g.iH)(e.ShowNavBar),{height:T}=(0,H.iP)(),k=(0,g.iH)(T.value-46+"px");return{Refresh:a,onRefresh:u,list:l,onLoad:d,loading:i,finished:c,onNoteDetail:S,AddCategory:C,preDelItem:h,beforeClose:I,vheight:k,nextTop:y,showNavbar:x,showSwitchBtn:!e.IsAll}}},It=()=>{(0,c.sj)((e=>({"3decdd3b":e.vheight})))},Nt=wt.setup;wt.setup=Nt?(e,t)=>(It(),Nt(e,t)):It;var Ct=wt;const St=(0,w.Z)(Ct,[["render",vt]]);var xt=St;const Tt={class:"addcycontent"},kt={class:"categorylist"},Dt=(0,s._)("span",null,"分类",-1),Lt=(0,s.Uk)("添加"),_t={class:"listdata"},Pt={style:{"text-align":"center"}},Ft=(0,s.Uk)("删除知识库");function Ht(e,t,o,n,a,l){const i=(0,s.up)("van-nav-bar"),r=(0,s.up)("van-cell"),u=(0,s.up)("van-button"),d=(0,s.up)("van-row"),f=(0,s.up)("van-swipe-cell"),h=(0,s.up)("van-dialog");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,{title:n.PageTitle,"left-text":"返回","right-text":"保存","left-arrow":"",onClickLeft:n.onClickLeft,onClickRight:n.onClickRight},null,8,["title","onClickLeft","onClickRight"]),(0,s._)("div",Tt,[(0,s.wy)((0,s._)("input",{type:"text",class:"title",placeholder:"标题","onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e)},null,512),[[c.nr,n.title]]),(0,s.Wm)(r,{class:"date-info",title:n.createTime,"onUpdate:title":t[1]||(t[1]=e=>n.createTime=e),icon:"calendar-o"},null,8,["title"]),(0,s.wy)((0,s._)("textarea",{class:"note-content",rows:"6",placeholder:"描述","onUpdate:modelValue":t[2]||(t[2]=e=>n.content=e)},null,512),[[c.nr,n.content]]),(0,s._)("div",kt,[(0,s._)("p",null,[Dt,(0,s.Wm)(u,{onClick:t[3]||(t[3]=e=>n.addCategory(0,"",-1)),style:{padding:"0px 3px",height:"24px",position:"absolute",right:"24px"},type:"primary"},{default:(0,s.w5)((()=>[Lt])),_:1})]),(0,s._)("div",_t,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.list,((e,t)=>((0,s.wg)(),(0,s.j4)(f,{key:t},{right:(0,s.w5)((()=>[(0,s.Wm)(u,{square:"",type:"primary",text:"编辑",onClick:o=>n.addCategory(e.Id,e.tname,t)},null,8,["onClick"]),(0,s.Wm)(u,{square:"",type:"danger",text:"删除",onClick:o=>n.delCategory(e.Id,e.tname,e.TotalNoteNum,t)},null,8,["onClick"])])),default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"vrow"},{default:(0,s.w5)((()=>[(0,s._)("p",Pt,(0,C.zw)(e.name),1)])),_:2},1024)])),_:2},1024)))),128))])]),n.Id>0?((0,s.wg)(),(0,s.j4)(u,{key:0,type:"danger",style:{"margin-top":"60px"},block:"",onClick:n.delCyNote},{default:(0,s.w5)((()=>[Ft])),_:1},8,["onClick"])):(0,s.kq)("",!0)]),(0,s.Wm)(h,{class:"showPicUrlDialog",show:n.showPicUrl,"onUpdate:show":t[5]||(t[5]=e=>n.showPicUrl=e),title:"分类","show-cancel-button":"",onConfirm:n.showPicUrlconfirm},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("input",{type:"text",height:"30px","onUpdate:modelValue":t[4]||(t[4]=e=>n.categoryName=e),placeholder:"分类名称"},null,512),[[c.nr,n.categoryName]])])),_:1},8,["show","onConfirm"])],64)}var Ot={name:"AddCategoryView",components:{RichText:ke},setup(){const e=(0,m.oR)(),t=(0,b.yj)();(0,s.bv)((()=>{e.commit("SelectTabBar",1),console.log("加载")})),(0,s.Ah)((()=>{e.commit("SelectTabBar",-1),console.log("卸载")})),(0,s.dl)((()=>{console.log("addNote onActivated")}));const o=e=>(e=e??"",e.length>0&&e.length>50&&(e=e.substring(0,50)),e),n=()=>{history.back()},a=()=>{if(0==c.value.trim().length){if(0==r.value.trim().length)return void v.FN.fail("请输入内容");c.value=o(temTitle.value)}if(l.value>0)e.dispatch("updateNote",{Id:l.value,Title:c.value,Category:"",Content:r.value,ParentId:f.value,note_category_Id:h.value}).then((t=>{t.rowsAffected>0&&((0,v.FN)("保存成功"),e.commit("setRefreshListState",!0),setTimeout((()=>{history.back()}),300))})).catch((e=>{v.FN.fail("保存失败："+e)}));else{const t=new Date,o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();e.dispatch("addCyNote",{Id:l.value,Title:c.value,SType:1,Content:r.value,CreateTime:u.value,Year:o,Month:n,Day:a,timestamp:Date.now(),ParentId:f.value,note_category_Id:h.value}).then((t=>{if(console.log(JSON.stringify(t)),t.rowsAffected>0){var o=t.insertId;if(e.commit("setRefreshListState",!0),y.value.length>0)for(let t=0;t<y.value.length;t++){const n=y.value[t];e.dispatch("addCategory",{CName:n.tname,note_Id:o,Des:""}).then((e=>{console.log(JSON.stringify(e)),e.rowsAffected>0&&console.log("分类添加成功")})).catch((e=>{v.FN.fail("添加失败："+e)}))}(0,v.FN)("创建成功"),setTimeout((()=>{history.back()}),300)}})).catch((e=>{v.FN.fail("添加失败："+e)}))}},l=(0,g.iH)(t.query.Id?Number(t.query.Id):0),i=(0,g.iH)(t.query.back??0),c=(0,g.iH)(""),r=(0,g.iH)(""),u=(0,g.iH)(q()),d=(0,g.iH)("创建知识库"),f=(0,g.iH)(0),h=(0,g.iH)(0),p=(0,g.iH)(0);console.log("Id.value",l.value),l.value&&l.value>0&&(d.value="编辑知识库",e.dispatch("getNoteById",l.value).then((e=>{const t=e;c.value=t.Title,r.value=t.Content,u.value=t.CreateTime,f.value=t.ParentId,h.value=t.note_category_Id,p.value=t.totalNotes})).catch((e=>{console.log("查询笔记失败："+e),v.FN.fail("查询笔记失败："+e)})));const y=(0,g.iH)([]),w=()=>{y.value.length=0,e.dispatch("getCategoryList",{CyNoteId:l.value}).then((e=>{var t=e;console.log("getCategoryList=>"+JSON.stringify(t));for(let o=0;o<t.length;o++)y.value.push({Id:t[o].Id,name:t[o].CName+"("+t[o].TotalNoteNum+")",tname:t[o].CName,TotalNoteNum:t[o].TotalNoteNum})}))};w();const I=(0,g.iH)(!1),N=()=>{0==C.value.trim().length?(0,v.FN)("请输入分类名称"):l.value>0?S.value>0?e.dispatch("updateCategory",{Id:S.value,CName:C.value,note_Id:l.value,Des:""}).then((e=>{if(e.rowsAffected>0)for(let t=0;t<y.value.length;t++){const e=y.value[t];if(e.Id==S.value){e.name=C.value+"("+e.TotalNoteNum+")",e.tname=C.value;break}}})).catch((e=>{v.FN.fail("保存失败："+e)})):e.dispatch("addCategory",{CName:C.value,note_Id:l.value,Des:""}).then((e=>{console.log(JSON.stringify(e)),e.rowsAffected>0&&(S.value=e.insertId,y.value.push({name:C.value+"(0)",tname:C.value,Id:e.insertId,TotalNoteNum:0}))})).catch((e=>{v.FN.fail("添加失败："+e)})):x.value>=0?(y.value[x.value].name=C.value+"(0)",y.value[x.value].Id=S.value,y.value[x.value].tname=C.value):y.value.push({name:C.value+"(0)",tname:C.value,Id:0})},C=(0,g.iH)(""),S=(0,g.iH)(0),x=(0,g.iH)(-1),T=(e,t,o)=>{I.value=!0,x.value=o,0==e&&0==t.length?(C.value="",S.value=0):(C.value=t,S.value=e)},k=(t,o,n,a)=>{console.log(t,o,n,a),(0,F.WD)({title:"确定删除 '"+o+"' 分类？"}).then((()=>{n>0?v.FN.fail("该分类有数据不能删除!"):t>0?e.dispatch("delCategory",{Id:t,real:0}).then(((e,o)=>{if(e.rowsAffected>0){for(let e=0;e<y.value.length;e++){const o=y.value[e];if(o.Id==t){y.value.splice(e,1);break}}(0,yt.NU)({type:"success",message:"已删除",position:"bottom"})}else v.FN.fail("移出失败："+o)})):(y.value.splice(a,1),(0,yt.NU)({type:"success",message:"已删除",position:"bottom"}))})).catch((()=>{}))},D=()=>{(0,F.WD)({title:"是否删除该知识库？"}).then((()=>{p.value>0?v.FN.fail("知识库有数据不能删除!"):e.dispatch("delNote",{Id:l.value,real:0}).then(((t,o)=>{t.rowsAffected>0?(e.commit("setRefreshListState",!0),i.value&&0!=i.value?history.go(-2):history.back()):v.FN.fail("删除失败："+o)}))})).catch((()=>{}))};return{onClickLeft:n,onClickRight:a,PageTitle:d,title:c,categoryName:C,content:r,createTime:u,Id:l,list:y,showPicUrl:I,showPicUrlconfirm:N,addCategory:T,delCategory:k,delCyNote:D}}};const Ut=(0,w.Z)(Ot,[["render",Ht]]);var Rt=Ut;const At={class:"list-box-detail"},Wt={class:"cydes"},Mt={class:"cybody"};function Bt(e,t,o,n,a,l){const i=(0,s.up)("van-icon"),c=(0,s.up)("van-nav-bar"),r=(0,s.up)("down-outlined"),u=(0,s.up)("a-tree"),d=(0,s.up)("van-action-sheet");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(c,{class:"list-title",title:"知识库详情","left-text":"返回","left-arrow":"",onClickLeft:n.onClickLeft},{right:(0,s.w5)((()=>[(0,s._)("div",{class:"icon-box",onClick:t[0]||(t[0]=(...e)=>n.onSearch&&n.onSearch(...e))},[(0,s.Wm)(i,{name:"search",size:"22"})]),(0,s._)("div",{class:"icon-box",onClick:t[1]||(t[1]=(...e)=>n.onAddNote&&n.onAddNote(...e))},[(0,s.Wm)(i,{name:"plus",size:"22"})]),(0,s._)("div",{class:"icon-box",onClick:t[2]||(t[2]=(...e)=>n.onShowActionsheet&&n.onShowActionsheet(...e))},[(0,s.Wm)(i,{name:"ellipsis",size:"25"})])])),_:1},8,["onClickLeft"]),(0,s._)("div",At,[(0,s._)("div",Wt,[(0,s._)("h2",null,(0,C.zw)(n.menuTitle),1),(0,s._)("p",null,(0,C.zw)(n.menuContent),1)]),(0,s._)("div",Mt,[(0,s.Wm)(u,{"tree-data":n.treeData,"default-expandAll":!0,onExpand:n.expandNode,onSelect:n.selectNode,expandedKeys:n.expandedKeys,"onUpdate:expandedKeys":t[3]||(t[3]=e=>n.expandedKeys=e)},{switcherIcon:(0,s.w5)((({switcherCls:e})=>[(0,s.Wm)(r,{class:(0,C.C_)(e)},null,8,["class"])])),_:1},8,["tree-data","onExpand","onSelect","expandedKeys"])])]),(0,s.Wm)(d,{show:n.showSheet,"onUpdate:show":t[4]||(t[4]=e=>n.showSheet=e),onSelect:n.selectSheet,actions:n.actionsSheet,"cancel-text":"取消","close-on-click-action":"",onCancel:n.onCancel},null,8,["show","onSelect","actions","onCancel"])],64)}var Yt=o(5747),jt={name:"CategoryDetailView",props:{},components:{DownOutlined:Yt.Z},setup(e){const t=(0,b.tv)(),o=(0,b.yj)(),n=(0,m.oR)(),a=async e=>await n.getters.getLocalItem(e),l=(0,g.iH)(o.query.CyId?Number(o.query.CyId):0);console.log(l.value);const i=(0,g.iH)([]),c=e=>{n.dispatch("getCategoryList",{CyNoteId:e}).then((t=>{var o=t;console.log("getCategoryList=>"+JSON.stringify(o));let l=[];for(let e=0;e<o.length;e++)l.push({key:"cy_"+o[e].Id,title:o[e].CName,selectable:!0,class:"cyLParentNote",timestamp:o[e].Timestamp,children:[]}),a("cy_"+o[e].Id).then((e=>{e&&i.value.push(e)}));n.dispatch("getNoteListByParentId",{ParentId:e}).then((e=>{var t=e;console.log("getNoteListByParentId=>"+JSON.stringify(t)),p.value.length=0;for(let o=0;o<t.length;o++){let e=t[o];if(0!=e.note_category_Id)for(let t=0;t<l.length;t++){const o=l[t];let n="cy_"+e.note_category_Id;if(o.key==n&&o.children){o.children.push({title:e.Title,key:e.Id,class:"cyLleafNote"});break}}else r({title:e.Title,key:e.Id,class:"cyLleafNote",timestamp:e.Timestamp},l)}for(let o=0;o<l.length;o++){const e=l[o];p.value.push(e)}console.log(p.value)}))}))};c(l.value);const r=(e,t)=>{if(e&&t)if(0!=t.length)for(let o=t.length-1;o>=0;o--){const n=t[o];if(e.timestamp>n.timestamp){t.splice(o+1,0,e);break}0==o&&t.splice(o,0,e)}else t.push(e)},u=(0,g.iH)(""),d=(0,g.iH)(""),f=e=>{n.dispatch("getNoteById",e).then((e=>{const t=e;u.value=t.Title,d.value=t.Content})).catch((e=>{console.log("查询笔记失败："+e)}))};f(l.value),(0,s.dl)((()=>{n.commit("SelectTabBar",1),console.log("cydetail onActivated")})),(0,s.bv)((()=>{n.commit("SelectTabBar",1),console.log("加载")})),(0,s.Ah)((()=>{n.commit("SelectTabBar",-1),console.log("卸载")}));const h=()=>{history.back()},p=(0,g.iH)([]),v=(0,g.iH)(-1),y=(e,o)=>{if(console.log(e,o),e.length>0){let e=o.node.key+"";-1!=e.indexOf("cy_")?v.value=Number(e.substring(e.indexOf("cy_")+3)):(v.value=-1,t.push({path:"/ViewNote",query:{Id:e}}))}else v.value=-1},w=(e,t)=>{console.log(e,t),t.expanded?n.commit("setLocalItem",{key:t.node.key,val:t.node.key}):n.commit("removeLocalItem",t.node.key)},I=()=>{t.push({path:"/Search",query:{CyId:l.value,CaId:v.value,kw:"",lz:1}})},N=()=>{t.push({path:"/AddNote",query:{Id:0,CyId:l.value,NCId:v.value,State:0}})},C=(0,g.iH)(!1),S=()=>{C.value=!0},x=[{name:"编辑"},{name:"刷新"}],T=()=>console.log("取消"),k=(e,o)=>{console.log(e,o),0==o?t.push({path:"/AddCategory",query:{Id:l.value,back:1}}):1==o&&(f(l.value),c(l.value))};return{treeData:p,selectNode:y,expandNode:w,expandedKeys:i,onClickLeft:h,onSearch:I,onAddNote:N,menuTitle:u,menuContent:d,showSheet:C,selectSheet:k,actionsSheet:x,onCancel:T,onShowActionsheet:S}}};const Vt=(0,w.Z)(jt,[["render",Bt]]);var qt=Vt;const Et=[{path:"/",name:"NotesView",component:M},{path:"/AddNote",name:"AddNoteView",components:{NewNote:He}},{path:"/ViewNote",name:"ViewNoteView",components:{NewNote:$e}},{path:"/Category",name:"CategoryView",component:xt},{path:"/AddCategory",name:"AddCategory",components:{NewNote:Rt}},{path:"/CategoryDetail",name:"CategoryDetailView",components:{NewNote:qt}},{path:"/Calendar",name:"CalendarView",component:ot},{path:"/Search",name:"SearchView",components:{NewNote:ht}},{path:"/Setting",name:"SettingView",component:ct}],Jt=(0,b.p7)({history:(0,b.PO)(""),routes:Et});var zt=Jt,$t={PreTabbarIndex:0,CurTabbarIndex:0,database:{},RefreshListState:!1,localFingerKey:"openFingerprint"};function Kt(e){return!(1==e.CurTabbarIndex)}function Zt(){return e=>localStorage.getItem(e)}function Gt(e,t){t<0?(e.CurTabbarIndex=e.PreTabbarIndex,e.PreTabbarIndex=0):(e.PreTabbarIndex=e.CurTabbarIndex,e.CurTabbarIndex=t)}function Qt(e,t){e.database=t}function Xt(e,t){e.RefreshListState=t}function eo(e,t){localStorage.setItem(t.key,t.val)}function to(e,t){localStorage.removeItem(t)}function oo(e,t){return new Promise((o=>{e=e||"default_database_db";const n="browser"===window.cordova.platformId?window.openDatabase(e,"1.0","Data",2097152):window.sqlitePlugin.openDatabase({name:e+".db",androidDatabaseLocation:t});o(n)}))}function no(e,t){if(null==e||null==t)return"";var o=t.tableName,n=t.fields;if(""==o||null==o||void 0==o)return"";Object.prototype.hasOwnProperty.call(n,"Id")||(n["Id"]="integer");var a=[];for(let c in n)"Id"!=c?a.push('"'+c+'" '+n[c]+","):a.push('"Id" integer NOT NULL PRIMARY KEY AUTOINCREMENT,');let l=a.length,i=a[l-1];return a[l-1]=i.substring(0,i.lastIndexOf(",")),new Promise(((t,n)=>{e.transaction((function(e){const n='CREATE TABLE IF NOT EXISTS "'+o+'" ( \n                '+a.join(" ")+" \n            )";console.log("SQL===> "+n),e.executeSql(n,[],((e,o)=>{t(o),o.rowsAffected>0&&console.log("fileinfo 创建成功")}))}),(function(e){console.log("transaction error: "+e.message),n("transaction error: "+e.message)}),(function(){console.log("resolve transaction ok")}))}))}function ao(e){return!!e&&("text"!=e.toLowerCase()&&"blob"!=e.toLowerCase())}function lo(e,t,o,n){var a=t.tableName,l=t.fields,i="";if("object"==typeof o){for(let e in o)ao(l[e])?i+=e+" = "+o[e]+" and ":i+=e+" = '"+o[e]+"' and ";i=i.substring(0,i.lastIndexOf("and"))}else"string"==typeof o&&(i=o);var c="";if("object"==typeof n){for(let e in n)ao(l[e])?c+=e+" = "+n[e]+" , ":c+=e+" = '"+n[e]+"' , ";c=c.substring(0,c.lastIndexOf(","))}else"string"==typeof n&&(c=n);return new Promise(((t,o)=>{e.transaction((function(e){var n="";n=""==c?"delete from "+a+" WHERE "+i:"update "+a+" set "+c+" WHERE "+i,console.log("SQL===> "+n),e.executeSql(n,[],(function(e,o){t({rowsAffected:o.rowsAffected})}),(function(e,t){console.log("DELETE error: "+t.message),o("DELETE  error: "+t.message)}))}),(function(e){console.log("transaction error: "+e.message)}),(function(){console.log("transaction ok")}))}))}function io(e,t,o,n){var a=t.tableName,l=(t.fields,""),i=[];if("object"==typeof n){for(let e in n)l+=e+" = ?, ",i.push(n[e]);l=l.substring(0,l.lastIndexOf(","))}else"string"==typeof n&&(l=n);var c="";if("object"==typeof o){for(let e in o)c+=e+" = ? and ",i.push(o[e]);c=c.substring(0,c.lastIndexOf("and"))}else"string"==typeof o&&(c=o);return new Promise(((t,o)=>{e.transaction((function(e){var n="update "+a+" set "+l+" WHERE "+c;console.log("SQL===> "+n+"   data:("+i.join(",")+")"),e.executeSql(n,i,(function(e,o){t({rowsAffected:o.rowsAffected})}),(function(e,t){console.log("update error: "+t.message),o("update  error: "+t.message)}))}),(function(e){console.log("transaction error: "+e.message)}),(function(){console.log("transaction ok")}))}))}function co(e,t,o){var n=t.tableName,a="",l="",i=[];if("object"==typeof o){delete o.Id;for(let e in o)a+=e+" , ",l+="?,",i.push(o[e]);a=a.substring(0,a.lastIndexOf(",")),l=l.substring(0,l.lastIndexOf(","))}return new Promise(((t,o)=>{e.transaction((function(e){var c="INSERT INTO "+n+" ("+a+") VALUES ("+l+")";console.log("SQL===> "+c+"   data:("+i.join(",")+")"),e.executeSql(c,i,(function(e,o){t(o)}),(function(e,t){console.log("INSERT error: "+t.message),o("INSERT error: "+t.message)}))}),(function(e){console.log("transaction error: "+e.message)}),(function(){console.log("transaction ok")}))}))}function so(e,t,o,n,a){var l=t.tableName,i=t.fields,c="";let s=[];for(let d in i)d.endsWith("_Id")&&s.push(d.substring(0,d.lastIndexOf("_Id"))),-1!=d.indexOf(".")?c+=d+",":c+=l+"."+d+",";n&&(n.endsWith(",")?c+=n:c+=n+","),c=c.substring(0,c.lastIndexOf(","));var r="";if("object"==typeof o){for(let e in o){let t="";t=-1==e.indexOf(".")?l+"."+e:e,ao(i[e])?r+=t+" = "+o[e]+" and ":r+=t+" = '"+o[e]+"' and "}r=r.substring(0,r.lastIndexOf("and"))}else"string"==typeof o&&(r=o);a=a?" order by "+a:"";var u="";if(s.length>0)for(let d=0;d<s.length;d++){const e=s[d];u+=` left join  ${e} on ${e}.Id = ${l}.${e}_Id `}return new Promise(((t,o)=>{e.transaction((e=>{const o="select "+c+" from "+l+u+" where "+r+" "+a;console.log("SQL===> "+o),e.executeSql(o,[],((e,o)=>{for(var n={},a=0;a<o.rows.length;a++){n=o.rows.item(a);break}t(n)}))}),(function(e){o(e.message)}),(function(){}))}))}function ro(e,t,o,n,a,l,i){var c=t.tableName,s=t.fields,r="";let u=[];for(let m in s)i&&-1!=i.indexOf(m)||(m.endsWith("_Id")&&u.push(m.substring(0,m.lastIndexOf("_Id"))),-1!=m.indexOf(".")?r+=m+",":r+=c+"."+m+",");n&&(n.endsWith(",")?r+=n:r+=n+","),r=r.substring(0,r.lastIndexOf(","));var d="";if("object"==typeof o){for(let e in o){let t="";t=-1==e.indexOf(".")?c+"."+e:e,ao(s[e])?d+=t+" = "+o[e]+" and ":d+=t+" = '"+o[e]+"' and "}d=d.substring(0,d.lastIndexOf("and"))}else"string"==typeof o&&(d=o);0==d.trim().length&&(d=" 1 = 1 "),a=a?" order by "+a:" order by "+c+".Id asc ";var f="";if(l&&"object"==typeof l&&Object.prototype.hasOwnProperty.call(l,"pageIndex")&&Object.prototype.hasOwnProperty.call(l,"pageSize")){var h=l.pageIndex,g=l.pageSize;h<1&&(h=1),h=(h-1)*g,f=" limit "+h+","+g}var b="";if(u.length>0)for(let m=0;m<u.length;m++){const e=u[m];b+=` left join  ${e} on ${e}.Id = ${c}.${e}_Id `}return new Promise(((t,o)=>{e.transaction((e=>{const o="select "+r+" from "+c+b+" where "+d+" "+a+" "+f;console.log("SQL===> "+o),e.executeSql(o,[],((e,o)=>{for(var n=[],a=0;a<o.rows.length;a++)n.push(o.rows.item(a));t(n)}))}),(function(e){o(e.message)}),(function(){}))}))}const uo={tableName:"note",fields:{Id:"integer",ParentId:"integer",SType:"integer",Title:"text",Category:"text",note_category_Id:"integer",Content:"text",CreateTime:"text",State:"integer",Year:"integer",Month:"integer",Day:"integer",Sort:"integer",Timestamp:"integer"}},fo={tableName:"note_version",fields:{Version:"text",Timestamp:"integer",Des:"text",CreateTime:"text",Info1:"text",Info2:"text",Info3:"text",State:"integer",Sort:"integer"}},ho={tableName:"note_category",fields:{CName:"text",Timestamp:"integer",note_Id:"integer",Des:"text",CreateTime:"text",State:"integer"}};function go(e,t){return new Promise(((o,n)=>{let a="(select count(1) from note nn where ifnull(nn.SType,0) = 0 and nn.ParentId = note.Id ) as totalNotes";so(e.state.database,uo,{Id:t},a).then((e=>{o(e)})).catch((e=>{n(e)}))}))}function bo(e,{Year:t,Month:o,Date:n}){return new Promise(((a,l)=>{var i="count(1) as cnt";so(e.state.database,{tableName:uo.tableName,fields:[]},`ifnull(note.SType,0) = 0 and note.Year =${t} and note.Month=${o} and note.Day=${n}`,i).then((e=>{for(var t=0,o=0;o<e.rows.length;o++){t=e.rows.item(o).cnt;break}a(t)})).catch((e=>{l(e)}))}))}function mo(e,{pageIndex:t=1,pageSize:o=20,Year:n=0,Month:a=0,Day:l=0,State:i=0,Sort:c=0,kw:s="",ParentId:r=0,note_category_Id:u=0}){return new Promise(((d,f)=>{var h={pageIndex:t,pageSize:o},g={};i>0&&(g.State=i),n>0&&(g.Year=n),a>0&&(g.Month=a),l>0&&(g.Day=l);var b=" ifnull(note.SType,0) = 0 and ";for(let e in g)No(uo.fields[e])?b+="note."+e+" = "+g[e]+" and ":b+="note."+e+" = '"+g[e]+"' and ";console.log("kw:",s,typeof s,void 0!==s&&s.trim().length>0),void 0!==s&&s.trim().length>0&&(b+=" ( note.Title like '%"+s.trim()+"%'  OR note.Content like '%"+s.trim()+"%'  ) and "),r>0&&(b+=" note.ParentId = "+r+" and "),u>=0&&(b+=" note.note_category_Id = "+u+" and "),b=b.substring(0,b.lastIndexOf("and"));let m="note.Sort desc,note.Timestamp desc";void 0!=c&&c>0&&(m="note.Timestamp desc"),ro(e.state.database,uo,b,"",m,h,["Content"]).then((e=>{d(e)})).catch((e=>{f(e)}))}))}function po(e,{pageIndex:t=1,pageSize:o=20,Year:n=0,Month:a=0,Day:l=0,State:i=0,Sort:c=0,kw:s=""}){return new Promise(((r,u)=>{var d={pageIndex:t,pageSize:o},f={};i>0&&(f.State=i),n>0&&(f.Year=n),a>0&&(f.Month=a),l>0&&(f.Day=l);var h=" ifnull(note.SType,0) = 1 and ";for(let e in f)No(uo.fields[e])?h+="note."+e+" = "+f[e]+" and ":h+="note."+e+" = '"+f[e]+"' and ";console.log("kw:",s,typeof s,void 0!==s&&s.trim().length>0),void 0!==s&&s.trim().length>0&&(h+=" ( note.Title like '%"+s.trim()+"%'  OR note.Content like '%"+s.trim()+"%'  ) and "),h=h.substring(0,h.lastIndexOf("and"));let g="note.Sort desc,note.Timestamp desc";void 0!=c&&c>0&&(g="note.Timestamp desc");let b="(select count(1) from note nn where nn.SType = 0 and nn.ParentId = note.Id ) as totalNotes";ro(e.state.database,uo,h,b,g,d,["Content","note_category_Id"]).then((e=>{r(e)})).catch((e=>{u(e)}))}))}function vo(e,{Title:t,SType:o,Content:n,CreateTime:a,Year:l,Month:i,Day:c,timestamp:s}){return new Promise(((r,u)=>{co(e.state.database,uo,{Id:0,Title:t,SType:o,Content:n,CreateTime:a,Year:l,Month:i,Day:c,State:1,Sort:1,Timestamp:s}).then((e=>{r(e)})).catch((e=>{u(e)}))}))}function yo(e,{CName:t,note_Id:o,Des:n}){var a=q(),l=E();return new Promise(((i,c)=>{co(e.state.database,ho,{Id:0,CName:t,note_Id:o,Des:n,CreateTime:a,Timestamp:l,State:1}).then((e=>{i(e)})).catch((e=>{c(e)}))}))}function wo(e,{Id:t,CName:o,note_Id:n,Des:a}){return new Promise(((l,i)=>{io(e.state.database,ho,{Id:t},{CName:o,note_Id:n,Des:a,State:1}).then((e=>{l(e)})).catch((e=>{i(e)}))}))}function Io(e,{Id:t,timestamp:o}){return new Promise(((n,a)=>{io(e.state.database,uo,{Id:t},{Timestamp:o}).then((e=>{n(e)})).catch((e=>{a(e)}))}))}function No(e){return!!e&&("text"!=e.toLowerCase()&&"blob"!=e.toLowerCase())}function Co(e,{Year:t,Month:o}){return new Promise(((n,a)=>{const l=J(t,o),i=z(t,o);ro(e.state.database,uo,`ifnull(note.SType,0) = 0 and (note.Year = ${l.Year} and note.Month=${l.Month} or note.Year = ${t} and note.Month=${o} or note.Year = ${i.Year} and note.Month=${i.Month})`,"","note.Year desc,note.Month desc",null,["Content"]).then((e=>{n(e)})).catch((e=>{a(e)}))}))}function So(e){return new Promise(((t,o)=>{let n=" (select count(1) from note nn where ifnull(nn.SType,0)=0 and nn.ParentId = note.Id) as TotalNoteNum ";ro(e.state.database,uo,"ifnull(note.SType,0) = 1 and note.State = 1 ",n,"note.Sort desc,note.Timestamp desc",null,["Content"]).then((e=>{t(e)})).catch((e=>{o(e)}))}))}function xo(e,{note_category_Id:t}){return new Promise(((o,n)=>{ro(e.state.database,uo,`ifnull(note.SType,0) = 0 and note.note_category_Id = ${t}`,"","note.Timestamp asc",null,["Content"]).then((e=>{o(e)})).catch((e=>{n(e)}))}))}function To(e,{ParentId:t}){return new Promise(((o,n)=>{let a=" note_category.CName ";ro(e.state.database,uo,`ifnull(note.SType,0) = 0 and note.ParentId = ${t}`,a,"note.note_category_Id asc,note.Timestamp asc",null,["Content"]).then((e=>{o(e)})).catch((e=>{n(e)}))}))}function ko(e,{Title:t,Category:o,Content:n,CreateTime:a,Year:l,Month:i,Day:c,timestamp:s,ParentId:r,note_category_Id:u,State:d}){return new Promise(((f,h)=>{co(e.state.database,uo,{Id:0,Title:t,Category:o,Content:n,CreateTime:a,SType:0,Year:l,Month:i,Day:c,State:d,Sort:1,Timestamp:s,ParentId:r,note_category_Id:u}).then((e=>{f(e)})).catch((e=>{h(e)}))}))}function Do(e,{Id:t,Title:o,Category:n,Content:a,ParentId:l,note_category_Id:i}){return new Promise(((c,s)=>{const r=E();io(e.state.database,uo,{Id:t},{Title:o,Category:n,Content:a,Timestamp:r,ParentId:l,note_category_Id:i}).then((e=>{c(e)})).catch((e=>{s(e)}))}))}function Lo(e,{Id:t,Sort:o}){return new Promise(((n,a)=>{io(e.state.database,uo,{Id:t},{Sort:o,State:1}).then((e=>{n(e)})).catch((e=>{a(e)}))}))}function _o(e,{Id:t,real:o}){return new Promise(((n,a)=>{0==o?lo(e.state.database,uo,{Id:t},{State:0}).then((e=>{n(e)})).catch((e=>{a(e)})):lo(e.state.database,uo,{Id:t},"").then((e=>{n(e)})).catch((e=>{a(e)}))}))}function Po(e,{Id:t,real:o}){return new Promise(((n,a)=>{0==o?lo(e.state.database,ho,{Id:t},{State:0}).then((e=>{n(e)})).catch((e=>{a(e)})):lo(e.state.database,ho,{Id:t},"").then((e=>{n(e)})).catch((e=>{a(e)}))}))}function Fo(e,{CyNoteId:t}){return new Promise(((o,n)=>{let a="(select count(1) from note nn where ifnull(nn.SType,0)=0 and nn.note_category_Id = note_category.Id) as TotalNoteNum";ro(e.state.database,ho,`note_category.note_Id = ${t} and note_category.State = 1 `,a,"note_category.Timestamp asc",null,[]).then((e=>{o(e)})).catch((e=>{n(e)}))}))}function Ho(e,t){return new Promise(((o,n)=>{let a="note.Title";so(e.state.database,ho,{Id:t},a).then((e=>{o(e)})).catch((e=>{n(e)}))}))}function Oo(e){return new Promise((t=>{document.addEventListener("deviceready",(()=>{oo("NoteDatabase",te).then((o=>{const n=o;e.commit("setDatabase",n),no(n,uo).then((e=>{e.rowsAffected>0&&console.log("fileinfo 创建成功")})).catch((e=>{console.log(e)})),no(n,ho).then((e=>{e.rowsAffected>0&&console.log("noteCategory 创建成功")})).catch((e=>{console.log(e)})),no(n,fo).then((e=>{e.rowsAffected>0&&console.log("version 创建成功")})).catch((e=>{console.log(e)})),t(n)}))}))}))}var Uo=(0,m.MT)({state:$t,getters:n,mutations:a,actions:l,modules:{}}),Ro=o(5258),Ao=o(4521),Wo=o(3805),Mo=o(6056),Bo=o(1441),Yo=o(5943),jo=o(5331),Vo=o(4250),qo=o(9420),Eo=o(3739),Jo=o(3649),zo=o(3812),$o=o(3996),Ko=o(257),Zo=o(9545),Go=o(7404),Qo=o(6305),Xo=o(6035),en=o(147),tn=o(1855),on=o(8596),nn=o(1174),an=o(134),ln=o(7619),cn=o(4715),sn=o(1160),rn=o(9723),un=o(3855);o(5110),o(1849);const dn=(0,c.ri)(N);dn.use(Uo),dn.use(zt),dn.use(Ro.Er),dn.use(Ao.QP),dn.use(Wo.JX),dn.use(Mo.X2),dn.use(Bo.I8),dn.use(Yo.aV),dn.use(jo.TS),dn.use(Vo.bL),dn.use(qo.l2),dn.use(Eo.gN),dn.use(jo.TS),dn.use(Jo.JO),dn.use(zo.J2),dn.use($o.f),dn.use(Ko.Q1),dn.use(Zo.zx),dn.use(Go.gU),dn.use(Qo.GI),dn.use(Xo.rs),dn.use(en.ol),dn.use(tn.h_),dn.use(on.hP),dn.use(nn.Vq),dn.use(an.kF),dn.use(ln.FN),dn.use(cn.eT),dn.use(sn.Vb),dn.use(rn.vT),dn.use(un.od),dn.use(i.ZP),dn.mount("#app")}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,l){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],l=e[u][2];for(var c=!0,s=0;s<n.length;s++)(!1&l||i>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[s])}))?n.splice(s--,1):(c=!1,l<i&&(i=l));if(c){e.splice(u--,1);var r=a();void 0!==r&&(t=r)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,i=n[0],c=n[1],s=n[2],r=0;if(i.some((function(t){return 0!==e[t]}))){for(a in c)o.o(c,a)&&(o.m[a]=c[a]);if(s)var u=s(o)}for(t&&t(n);r<i.length;r++)l=i[r],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(u)},n=self["webpackChunkvue"]=self["webpackChunkvue"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(6676)}));n=o.O(n)})();
//# sourceMappingURL=app.2ae925c2.js.map